sap.ui.define(["jquery.sap.global","demo/controllers/BaseController","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/Router","sap/m/MessageToast"],function(e,t,r,s,o){"use strict";var i=new this.UserModel;var a="";return r.extend("demo.controllers.Users.ConfirmUser",{onInit:function(){this.getView().addEventDelegate({onBeforeShow:function(e){if(a=="correo@correo.com"){this.getView().byId("user_confirm").setValue("")}else{this.getView().byId("user_confirm").setValue(a)}this.getView().byId("pass1").setValue("");this.getView().byId("pass2").setValue("");this.getView().byId("hCode").setValue("")},onAfterShow:function(){var e=this.getOwnerComponent().getModel("configSite");e.setProperty("/barVisible",false)}},this);var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("ConfirmUser").attachPatternMatched(this._onObjectMatched,this)},activateAccount:function(e){var t=this.getView().byId("pass1").getValue();var r=this.getView().byId("pass2").getValue();var s=this.getView().byId("hCode").getValue();a=this.getView().byId("user_confirm").getValue();a=a.toUpperCase();this.checarConfirmado();if(t===r){if(t.length>=8){var o=false;var n={IOption:"3",IMail:a,IAcode:s,INewpass:t};var l=i.create("/headerAdmSet",n);if(l!=null){if(l.ESuccess==="X"){this.logon()}else{sap.m.MessageBox.error(l.EMessage)}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/logon.erroServer"))}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/confirmCon.pass"))}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/confirmCon.error"))}},logon:function(){var e=this.getView().byId("activeForm");var t=this.getView().byId("errorBox");e.setVisible(false);t.setVisible(true);var r=this.getView().byId("errorField");r.setText("Se activó la cuenta de forma correcta.");r.setState(sap.ui.core.ValueState.Success)},_onObjectMatched:function(e){a=e.getParameter("arguments").mail;var t=this.getView().byId("activeForm");var r=this.getView().byId("errorBox");var s=this.getView().byId("errorField");t.setVisible(true);r.setVisible(false)},checarConfirmado:function(){var e={IOption:"20",IMail:a};var t=i.create("/headerAdmSet",e);var r=false;var s=this.getView().byId("activeForm");var o=this.getView().byId("errorBox");var n=this.getView().byId("errorField");r=t!=null&&t.ESuccess==="X";s.setVisible(r);o.setVisible(!r);if(!r){n.setText("Lo sentimos el usuario ya fue activado previamente, intente ingresar a su cuenta o en caso de haber olvidado su contraseña presione el link para recuperación.");n.setState(sap.ui.core.ValueState.Warning)}},backLogin:function(){sap.ui.getCore().setModel(null,"logon");location.reload()}})});
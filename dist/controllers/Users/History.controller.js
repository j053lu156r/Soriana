sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/ui/core/mvc/Controller"],function(e,t){"use strict";var o=new this.UserModel;return t.extend("demo.controllers.Users.History",{onInit:function(){var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("historyUsers").attachPatternMatched(this._onSupplierMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this)},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("historyUsers",{layout:e,user:this._user,supplier:this._supplier})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("historyUsers",{layout:e,user:this._user,supplier:this._supplier})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/closeColumn");this.oRouter.navTo("detailUsers",{layout:e,user:this._user,supplier:this._supplier})},_onSupplierMatched:function(t){this._user=t.getParameter("arguments").user||this._user||"0",this._supplier=t.getParameter("arguments").supplier||this._supplier||"0";var r=o.getJsonModel("/headerAdmSet?$expand=ETHISTORINAV&$filter= IOption eq '5' and IIdusua eq '"+this._user+"'");var n=r.getProperty("/results/0");if(n!=null){if(n.ESuccess=="X"){this.getOwnerComponent().setModel(new e(n),"historyUserModel")}else{sap.m.MessageBox.error(n.EMessage)}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/logon.erroServer"))}},exportHistoryXls:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=[{name:e.getProperty("/historyU.userUC"),template:{content:this.getOwnerComponent().getModel("detailUserModel").getProperty("/Esusdata/SmtpAddr")}},{name:e.getProperty("/historyU.operationUC"),template:{content:"{Hname}"}},{name:e.getProperty("/global.dateUC"),template:{content:"{Erdat}"}},{name:e.getProperty("/global.timeUC"),template:{content:"{Cputm}"}},{name:e.getProperty("/historyU.chagedByUC"),template:{content:"{Email}"}},{name:e.getProperty("/global.vendorUC"),template:{content:"{Lifnr}"}},{name:e.getProperty("/historyU.functionUC"),template:{content:"{Fname}"}}];this.exportxls("historyUserModel","/ETHISTORINAV/results",t)}})});
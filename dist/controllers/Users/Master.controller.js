sap.ui.define(["jquery.sap.global","sap/ui/core/Fragment","demo/controllers/BaseController","sap/m/UploadCollectionParameter","sap/ui/core/mvc/Controller","sap/m/PDFViewer","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/Router","demo/models/BaseModel","sap/f/library"],function(e,t,s,o,i,r,l,n){"use strict";var a=new this.UserModel;return s.extend("demo.controllers.Users.Master",{onInit:function(){this._pdfViewer=new r;this.getView().addDependent(this._pdfViewer);this.getView().addEventDelegate({onBeforeShow:function(e){this.getOwnerComponent().setModel(new l,"tableItemsUsers")},onAfterShow:function(e){var t=this.getConfigModel();t.setProperty("/barVisible",true);this.getView().byId("filterMail").setValue("");this.getView().byId("colSor").setSelected(false);this.getView().byId("supplierInput").setEnabled(true);this.getView().byId("sendDorps").setSelected(false)}},this)},searchData:function(){if(!this.hasAccess(12)){return false}var e=false;if(!a.getModel()){a.initModel()}var t=this.getConfigModel().getProperty("/supplierInputKey");if(this.getView().byId("colSor").getSelected()){t="-1"}var s=this.getOwnerComponent().getModel("userdata").getProperty("/EIdusua");var o=this.getOwnerComponent().getModel("userdata").getProperty("/ERol");var i=this.getView().byId("filterMail").getValue();var r=this.getView().byId("sendDorps").getSelected();var n=this.getView().byId("callUser").getSelected();if(t==null||t==""){if(i==""){if(r==""){if(n==""){e=false;sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/global.searchFieldsEmpty"))}else{e=true}}else{e=true}}else{e=true}}else{e=true}if(e){var d="/headerAdmSet?$expand=ETNOMPROVNAV&$filter=IOption eq '10' and IRol eq '"+o+"'"+" and  IIdusua eq '"+s+"'";if(t!=null&&t!=""){d+=" and ILifnr eq '"+t+"'";e=true}if(r!=""){d+=" and IUnsubsc eq 'X'";e=true}if(i!=""){d+=" and IMail eq '"+i+"'";e=true}if(n!=""){d+=" and Zcallc eq 'X'";e=true}if(e){var u=new sap.m.BusyDialog;u.open();var p=a.getJsonModel(d);u.close();var g=p.getProperty("/results/0");this.getOwnerComponent().setModel(new l(g),"tableItemsUsers")}this.paginate("tableItemsUsers","/ETNOMPROVNAV",1,0)}},cambioValor:function(){this.getOwnerComponent().setModel(new l({}),"tableItemsUsers")},onValueHelpRequest1:function(){this.getOwnerComponent().setModel(new l({}),"tableItemsUsers");var e=this.getView();if(!this._pValueHelpDialog){this._pValueHelpDialog=sap.ui.core.Fragment.load({id:e.getId(),name:"demo.fragments.SupplierSelect",controller:this}).then(function(t){e.addDependent(t);return t})}this._pValueHelpDialog.then(function(e){e.open()})},onSelectColaborator:function(){if(this.getView().byId("colSor").getSelected()||this.getView().byId("callUser").getSelected()){this.getView().byId("supplierInput").setEnabled(false);var e=""}else{this.getView().byId("supplierInput").setEnabled(true)}},onExit:function(){if(this._oDialog){this._oDialog.destroy();this._oDialog=null}if(this._uploadDialog1){this._uploadDialog1.destroy();this._uploadDialog1=null}if(this._uploadDialog2){this._uploadDialog2.destroy();this._uploadDialog2=null}if(this._oPopover){this._oPopover.destroy();this._oPopover=null}this.getOwnerComponent().getModel("tableItemsUsers").destroy()},onListItemPress:function(e){var t=e.getSource().getBindingContext("tableItemsUsers").getPath(),s=t.split("/").slice(-1).pop();var o=this.getOwnerComponent().getModel("tableItemsUsers");var i=o.getProperty(t);if(i.Lifnr==""){i.Lifnr="-1"}this.getOwnerComponent().getRouter().navTo("detailUsers",{layout:sap.f.LayoutType.TwoColumnsMidExpanded,user:i.Idusua,supplier:i.Lifnr},true)},createUser:function(){if(!this.hasAccess(13)){return}this.getOwnerComponent().getRouter().navTo("NewUsers",{layout:sap.f.LayoutType.OneColumn},true)}})});
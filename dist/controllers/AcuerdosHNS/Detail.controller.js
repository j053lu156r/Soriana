sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController"],function(e,t){"use strict";var r=new this.Acuerdos;return t.extend("demo.controllers.AcuerdosHNS.Detail",{onInit:function(){var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailAcuerdosHNS").attachPatternMatched(this._onDocumentMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this)},handleItemPress:function(e){},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/fullScreen");this.oRouter.navTo("detailAcuerdosHNS",{layout:e,proveedor:this._proveedor,ref1:this._ref1,ref2:this._ref2,centro:this._centro})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/exitFullScreen");this.oRouter.navTo("detailAcuerdosHNS",{layout:e,proveedor:this._proveedor,ref1:this._ref1,ref2:this._ref2,centro:this._centro})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/closeColumn");this.oRouter.navTo("masterAcuerdosHNS",{layout:e})},_onDocumentMatched:function(t){this._proveedor=t.getParameter("arguments").proveedor||this._proveedor||"0";this._ref1=t.getParameter("arguments").ref1||this._ref1||"0";this._ref2=t.getParameter("arguments").ref2||this._ref2||"0";this._centro=t.getParameter("arguments").centro||this._centro||"0";if(this._ref2!=="NOREF2"){var o=this._ref1+"/"+this._ref2}else{o=this._ref1}var n={Proveedor:this._proveedor,Referencia:o,Centro:this._centro};this.getOwnerComponent().setModel(new e(n),"acuHeadDetHNSModel");var s="AcuerdosHNSDetSet?$filter=";s+="Lifnr eq '"+this._proveedor+"'";s+=" and Refer eq '"+o+"'";s+=" and Werks eq '"+this._centro+"'";this.getView().byId("AcuerdosDetHNS").setBusy(true);r.getJsonModelAsync(s,function(t,r){var o=t.getProperty("/results");if(o!=null){var n=o.reduce((e,t)=>+e+(+t["Canti"]||0),0);var s=o.reduce((e,t)=>+e+(+t["Cnorm"]||0),0);var a=o.reduce((e,t)=>+e+(+t["Cofer"]||0),0);var i=o.reduce((e,t)=>+e+(+t["Difer"]||0),0);var u=o.reduce((e,t)=>+e+(+t["Bonif"]||0),0);var c=o.reduce((e,t)=>+e+(+t["Impieps"]||0),0);var d=o.reduce((e,t)=>+e+(+t["Iva"]||0),0);var l={TotCanti:Number(n.toFixed(4)),TotCnorm:Number(s.toFixed(4)),TotCofer:Number(a.toFixed(4)),TotDifer:Number(i.toFixed(4)),TotBonif:Number(u.toFixed(4)),TotImpieps:Number(c.toFixed(4)),TotIva:Number(d.toFixed(4))};r.getOwnerComponent().setModel(new e(l),"acuTotDetHNSModel");r.getOwnerComponent().setModel(new e(o),"AcuDetHNSHdr")}r.getView().byId("AcuerdosDetHNS").setBusy(false)},function(e){e.getView().byId("AcuerdosDetHNS").setBusy(false)},this)},buildExportTable:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=[{name:e.getProperty("/acuerdosHNS.centro"),template:{content:"{Werks}"}},{name:e.getProperty("/acuerdosHNS.refer"),template:{content:"{Refer}"}},{name:e.getProperty("/acuerdosHNS.docCompras"),template:{content:"{Ebeln}"}},{name:e.getProperty("/acuerdosHNS.material"),template:{content:"{Matnr}"}},{name:e.getProperty("/acuerdosHNS.desc"),template:{content:"{Descp}"}},{name:e.getProperty("/acuerdosHNS.canti"),template:{content:"{Canti}"}},{name:e.getProperty("/acuerdosHNS.cNorm"),template:{content:"{Cnorm}"}},{name:e.getProperty("/acuerdosHNS.cOfer"),template:{content:"{Cofer}"}},{name:e.getProperty("/acuerdosHNS.difer"),template:{content:"{Difer}"}},{name:e.getProperty("/acuerdosHNS.bonif"),template:{content:"{Bonif}"}},{name:e.getProperty("/acuerdosHNS.ieps"),template:{content:"{Impieps}"}},{name:e.getProperty("/acuerdosHNS.iva"),template:{content:"{Iva}"}}];this.exportxls("AcuDetHNSHdr","/",t)}})});
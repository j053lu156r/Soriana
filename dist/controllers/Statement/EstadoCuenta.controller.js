sap.ui.define(["demo/controllers/BaseController","sap/ui/model/json/JSONModel","demo/models/BaseModel","sap/m/Label","sap/m/Link","sap/m/MessageToast","sap/m/Text","sap/ui/core/Fragment"],function(e,t,o,r,s,a,l,n){"use strict";var i="/sap/opu/odata/sap/ZOSP_STATEMENT_SRV_01/";var u;var d=new Date;return e.extend("demo.controllers.Statement.EstadoCuenta",{sCollection:"GroupedTotales>/Hierarchy",aCrumbs:["movimientos","positions"],mInitialOrderState:{products:{},count:0,hasCounts:false},onInit:function(){this.getView().addEventDelegate({onBeforeShow:function(e){this.clearFilters();this.getOwnerComponent().setModel(new t,"totales");this.getOwnerComponent().setModel(new t,"GroupedTotales");var o=new Date;o=o.getTime()-1e3*60*60*24*720;this.getView().byId("dateRange").setDateValue(new Date(o));this.getView().byId("dateRange").setSecondDateValue(new Date);var r=new t({filtros:[{filtro:"belnr",descripcion:"Documento"},{filtro:"xblnr",descripcion:"Factura"},{filtro:"",descripcion:""}]});this.getView().setModel(r,"filterOptions")}},this);if(!this._pTemplate){this._pTemplate=this.loadFragment({id:this.getView().getId(),name:"demo.views.Statement.Row"})}this._oTable=this.byId("idGroupTable");this._oTablev2=this.byId("detailsStatementList")},searchData:function(){let e=this.getView().byId("dateRange");let o=this.getView().byId("Belnr");let r=this.getView().byId("filtroBusqueda");let s=this.getConfigModel().getProperty("/supplierInputKey");console.log(this.byId("supplierInput").getValue());console.log(this.byId("supplierInput").getSelectedKey());let a=new Date;let l="20160219";let n=this.buildSapDate(a);let d=o.getValue();let p=this.getView().byId("checkPartidas");if(p.getSelected()){p.setSelected(false)}if(s==null||s==""){sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/global.supplierSelectError"));return false}if(l==""||n==""){}var c=r.getSelectedKey();var g="";if(c===""){g=""}else if(c==="belnr"){g=`and belnr eq '${d}' `}else if(c==="xblnr"){g=`and xblnr eq '${d}' `}var h=this.getOdata(i);let b=`EStmtHdrSet?$expand=Citms,Oitms&$filter= Lifnr eq '${s}' and Datei eq '${l}' and Datef eq '${n}' ${g} &$format=json`;var m=this.getOdataJsonModel(b,h);u=m.getJSON();var v=JSON.parse(u);let f=[...v.results[0].Citms.results,...v.results[0].Oitms.results];v.results[0].Detalles={results:[...f]};delete v.results[0].Citms;delete v.results[0].Oitms;v.results[0].periodo="Del "+this.formatDateTime(e.getDateValue(),"dd/MM/YYYY")+" al "+this.formatDateTime(e.getSecondDateValue(),"dd/MM/YYYY");var y=$.extend({},v.results[0]);var C=new t;C.setData(y);console.info("agrupando datos",f);let w=[...f];var I=this.groupArrayOfObjects(w,"DescripcionGpo");var T=[];var M=this;for(let e in I){var S=I[e].reduce(function(e,t){var o=t.Bschl==="21"?Number(t.Wrbtr):0;return e+o},0);var O=I[e].reduce(function(e,t){var o=t.Bschl!=="21"?Number(t.Wrbtr):0;var r=e+o;return r},0);var D=I[e];var V=D[0].IdNumGpo?D[0].IdNumGpo:"";T.push({IdNumGpo:V,name:e,totalRegs:I[e].length,totalDebit:Math.abs(this.truncate(O,2)),totalCredit:Math.abs(this.truncate(S,2)),positions:I[e]})}var B=T.reduce(function(e,t){var o=Number(t.totalRegs);var r=e+o;return r},0);var P=T.reduce(function(e,t){var o=Number(t.totalDebit);var r=e+o;return r},0);var A=T.reduce(function(e,t){var o=Number(t.totalCredit);var r=e+o;return r},0);var E=M.truncate(P,2)-M.truncate(A,2);E=E-.01;var x=new t({Hierarchy:{movimientos:T,totalR:B,totalD:M.truncate(P,2),totalC:M.truncate(A,2),totalT:M.truncate(E,2)},Bukrs:v.results[0].Bukrs});this.getOwnerComponent().setModel(x,"GroupedTotales");this.initTable();this.getOwnerComponent().setModel(C,"totales");this.paginate("totales","/Detalles",1,0)},onChange:function(){var e=this.getView().byId("dateRange").getDateValue();console.log(e)},searchDataV2:function(){let e=this.getView().byId("dateRange");let o=this.getView().byId("Belnr");let r=this.getView().byId("filtroBusqueda");let s=this.getConfigModel().getProperty("/supplierInputKey");console.log(s);console.log(this.byId("supplierInput").getValue().split("-")[0].trim());if(s===undefined){s=this.byId("supplierInput").getValue().split("-")[0].trim()}console.log(s);let a=new Date;console.log(this.buildSapDate(this.getView().byId("dateRange").getDateValue()));let l=this.buildSapDate(this.getView().byId("dateRange").getDateValue());let n=this.buildSapDate(a);let i="";let u=this.getView().byId("checkPartidas");if(u.getSelected()){u.setSelected(false)}if(s==null||s==""){sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/global.supplierSelectError"));return false}if(l==""||n==""){}var d="";var p="";var c=[];c.push(new sap.ui.model.Filter({path:"Lifnr",operator:sap.ui.model.FilterOperator.EQ,value1:s}));c.push(new sap.ui.model.Filter({path:"Datei",operator:sap.ui.model.FilterOperator.EQ,value1:l}));c.push(new sap.ui.model.Filter({path:"Datef",operator:sap.ui.model.FilterOperator.EQ,value1:n}));if(d==""){p=""}else if(d=="belnr"){c.push(new sap.ui.model.Filter({path:"belnr",operator:sap.ui.model.FilterOperator.EQ,value1:i}))}else if(d=="xblnr"){c.push(new sap.ui.model.Filter({path:"xblnr",operator:sap.ui.model.FilterOperator.EQ,value1:i}))}let g=this;var h=new t;var b=new t;g.getOwnerComponent().setModel(h,"GroupedTotales");g.initTable();g.getOwnerComponent().setModel(b,"totales");var m="ZOSP_STATEMENT_SRV_01";var v="EStmtHdrSet";var f=["Oitms"];var y=c;var C="";sap.ui.core.BusyIndicator.show();this._GetODataV2(m,v,y,f,C).then(function(e){sap.ui.core.BusyIndicator.hide();var o=e.data.results;let r=[...o[0].Oitms.results];var a=r.filter(e=>!e.Belnr.startsWith("58")&&!e.Belnr.startsWith("59"));var l=a.filter(e=>{if(e.DescripcionGpo===""){e.DescripcionGpo="AJUSTE DE FACTURAS";e.IdNumGpo="9";e.DescTipomov="CARGOS DIVERSOS";e.IdNumTipomov="65"}const t=new Date(e.Budat.replace(/-/g,"/"));return t<new Date});o[0].Detalles={results:[...l]};var n=$.extend({},o[0]);var i=new t;i.setData(n);let u=[...l];var d=g.groupArrayOfObjects(u,"DescripcionGpo");var p=[];for(let e in d){var c=d[e].reduce(function(e,t){var o=t.Bschl==="21"?Number(t.Wrbtr):0;var r=e+o;return r},0);var h=d[e].reduce(function(e,t){var o=t.Bschl!=="21"?Number(t.Wrbtr):0;var r=e+o;return r},0);var b=d[e];var m=b[0].IdNumGpo?b[0].IdNumGpo:"";p.push({IdNumGpo:m,name:e,totalRegs:d[e].length,totalDebit:Math.abs(g.truncate(h,2)),totalCredit:Math.abs(g.truncate(c,2)),positions:d[e]})}var v=p.reduce(function(e,t){var o=Number(t.totalRegs);var r=e+o;return r},0);var f=p.reduce(function(e,t){var o=Number(t.totalDebit);var r=e+o;return r},0);var y=p.reduce(function(e,t){var o=Number(t.totalCredit);var r=e+o;return r},0);var C=g.truncate(f,2)-g.truncate(y,2);C=C-.01;var w=new t({Hierarchy:{movimientos:p,totalR:v,totalD:g.truncate(f,2),totalC:g.truncate(y,2),totalT:g.truncate(C,2)},Bukrs:o[0].Bukrs,Lifnr:s});g.getOwnerComponent().setModel(w,"GroupedTotales");g.initTable();g.getOwnerComponent().setModel(i,"totales");g.paginate("totales","/Detalles",1,0)})},groupArrayOfObjects:function(e,t){return e.reduce(function(e,o){(e[o[t]]=e[o[t]]||[]).push(o);return e},{})},searchPartidasAbiertas:function(){let e=this.getView().byId("dateRange");let o=this.getView().byId("Belnr");let r=this.getView().byId("filtroBusqueda");let s=this.getConfigModel().getProperty("/supplierInputKey");let a=new Date;let l="20160219";let n=this.buildSapDate(a);let i=o.getValue();let u=this.getView().byId("checkPartidas");if(u.getSelected()){u.setSelected(false)}if(s==null||s==""){sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/global.supplierSelectError"));return false}if(l==""||n==""){}var d=r.getSelectedKey();var p="";let c=[];c.push(new sap.ui.model.Filter({path:"Lifnr",operator:sap.ui.model.FilterOperator.EQ,value1:s}));c.push(new sap.ui.model.Filter({path:"Datei",operator:sap.ui.model.FilterOperator.EQ,value1:l}));c.push(new sap.ui.model.Filter({path:"Datei",operator:sap.ui.model.FilterOperator.EQ,value1:n}));if(d==""){p=""}else if(d=="belnr"){c.push(new sap.ui.model.Filter({path:"belnr",operator:sap.ui.model.FilterOperator.EQ,value1:i}))}else if(d=="xblnr"){c.push(new sap.ui.model.Filter({path:"xblnr",operator:sap.ui.model.FilterOperator.EQ,value1:i}))}var g="ZOSP_STATEMENT_SRV_01";var h="EStmtHdrSet";var b=["Citms","Oitms"];var m=c;var v="";sap.ui.core.BusyIndicator.show();let f=this;this._GetODataV2(g,h,m,b,v).then(function(e){sap.ui.core.BusyIndicator.hide();var o=e.data.results;console.log(o);let r=[...o[0].Citms.results,...o[0].Oitms.results];o[0].Detalles={results:[...r]};var s=$.extend({},o[0]);var a=new t;a.setData(s);let l=[...r];var n=f.groupArrayOfObjects(l,"DescripcionGpo");var i=[];for(let e in n){var u=n[e].reduce(function(e,t){var o=t.Bschl==="21"?Number(t.Wrbtr):0;var r=e+o;return r},0);var d=n[e].reduce(function(e,t){var o=t.Bschl!=="21"?Number(t.Wrbtr):0;var r=e+o;return r},0);var p=n[e];var c=p[0].IdNumGpo?p[0].IdNumGpo:"";i.push({IdNumGpo:c,name:e,totalRegs:n[e].length,totalDebit:Math.abs(f.truncate(d,2)),totalCredit:Math.abs(f.truncate(u,2)),positions:n[e]})}var g=i.reduce(function(e,t){var o=Number(t.totalRegs);var r=e+o;return r},0);var h=i.reduce(function(e,t){var o=Number(t.totalDebit);var r=e+o;return r},0);var b=i.reduce(function(e,t){var o=Number(t.totalCredit);var r=e+o;return r},0);var m=f.truncate(h,2)-f.truncate(b,2);m=m-.01;var v=new t({Hierarchy:{movimientos:i,totalR:g,totalD:f.truncate(h,2),totalC:f.truncate(b,2),totalT:f.truncate(m,2)},Bukrs:o[0].Bukrs});f.getOwnerComponent().setModel(v,"GroupedTotales");f.initTable();f.getOwnerComponent().setModel(a,"totales");f.paginate("totales","/Detalles",1,0)})},onTableGrouping:function(e){console.log(e.getSource().getSelected());if(!e.getSource().getSelected()){this.searchDataV2()}else{this.searchPartidasAbiertas()}},initTable:function(){console.log("on init table");var e=this._getInitialPath();this._setAggregation(e);var t=this.byId("breadcrumb");var o=new s({text:"{appTxts>/aportaciones.concepto}",press:[e,this.onBreadcrumbPress,this]});t.destroyLinks();t.addLink(o)},_getInitialPath:function(){return[this.sCollection,this.aCrumbs[0]].join("/")},_nextCrumb:function(e){for(var t=0,o=this.aCrumbs.length;t<o;t++){if(this.aCrumbs[t]===e){return this.aCrumbs[t+1]}}},truncate:function(e,t){return Math.trunc(e*Math.pow(10,t))/Math.pow(10,t)},_stripItemBinding:function(e){var t=e.split("/");return t.slice(0,t.length-1).join("/")},_setAggregation:function(e){var t=e.split("/").reverse()[0];if(t===this.aCrumbs[this.aCrumbs.length-1]){this._oTable.setMode("None");this._oTable.setMode("None");this.byId("statusColumn").setVisible(true);this.byId("folioColumn").setVisible(true);this.byId("referenceColumn").setVisible(true);this.byId("typeDocColumn").setVisible(true);this.byId("dateColumn").setVisible(true);this.byId("dateVColumn").setVisible(true);this.byId("amountColumn").setVisible(true);this.byId("mCondicionColumn").setVisible(true);this.byId("bloqueoColumn").setVisible(true);this.byId("conciliacionColumn").setVisible(false);this.byId("tipoMovColumn").setVisible(true);this.byId("tipoColumn").setVisible(false);this.byId("totalRegColumn").setVisible(false);this.byId("debitColumn").setVisible(false);this.byId("creditColumn").setVisible(false);this.byId("verReporteColumn").setVisible(true);this.byId("sucursalColumn").setVisible(true);this.byId("folio2Column").setVisible(true)}else{this._oTable.setMode("SingleSelectMaster");this.byId("statusColumn").setVisible(false);this.byId("tipoMovColumn").setVisible(false);this.byId("folioColumn").setVisible(false);this.byId("referenceColumn").setVisible(false);this.byId("typeDocColumn").setVisible(false);this.byId("dateColumn").setVisible(false);this.byId("dateVColumn").setVisible(false);this.byId("amountColumn").setVisible(false);this.byId("mCondicionColumn").setVisible(false);this.byId("bloqueoColumn").setVisible(false);this.byId("conciliacionColumn").setVisible(false);this.byId("tipoColumn").setVisible(true);this.byId("totalRegColumn").setVisible(true);this.byId("debitColumn").setVisible(true);this.byId("creditColumn").setVisible(true);this.byId("verReporteColumn").setVisible(false);this.byId("sucursalColumn").setVisible(false);this.byId("folio2Column").setVisible(false)}console.log("SET agregation spath",e);this._oTablev2.bindRows({path:e});console.log(this._oTablev2);this._pTemplate.then(function(t){var o=[new sap.ui.model.Sorter("IdNumGpo")];this._oTable.bindAggregation("items",e,t,o)}.bind(this))},conceptoSelect:function(e){console.log("on condepto select");let t=e.getSource().getBindingContext("GroupedTotales").getPath();console.log(t);var o=t.split("/");var r=t.split("/").reverse()[1];var l=o[o.length-2];console.log("current path",l);if(r!==this.aCrumbs[this.aCrumbs.length-1]){var n=this.byId("breadcrumb");var i=o[o.length-2];var u=this.aCrumbs.indexOf(i)+1;console.log("currentNOde",u);var d=new s({text:"{GroupedTotales>name}",press:[t+"/"+this.aCrumbs[u],this.onBreadcrumbPress,this]});d.bindElement({path:"GroupedTotales>"+t});n.addLink(d)}if(l===this.aCrumbs[this.aCrumbs.length-1]){var p={};console.log("on documnt press",e);console.log(t);let o=this.getOwnerComponent().getModel("GroupedTotales").getProperty(t);var c=this.getOwnerComponent().getModel("GroupedTotales").getProperty("/Bukrs");var g=o.Budat;var h=g.substr(0,4)?g.substr(0,4):"";console.log(this.getOwnerComponent().getModel("totales"));var b=o.Tcode;console.log(c,h,b);var m=o.Belnr;var v=["MEB4","WLF4","MEB2","MEB0","WLF2","ZMMFILACUERDO","WFL5"];var f=["Z_APORTACIONES"];if(v.includes(b)&&m.startsWith("510")||b==""&&!(m.startsWith("1700")&&o.Xblnr)){console.log("on detailAcuerdosAS");this.getOwnerComponent().getRouter().navTo("detailAcuerdosAS",{layout:sap.f.LayoutType.MidColumnFullScreen,document:o.Belnr,sociedad:c,ejercicio:h,doc:o.Xblnr?o.Xblnr:"NA"},true)}else if(f.includes(b)||m.startsWith("1700")&&o.Xblnr){console.log("on detailAportacionesAS");if(o.LifnrAportacion!==""){this.getOwnerComponent().getRouter().navTo("detailAportacionesAS",{layout:sap.f.LayoutType.MidColumnFullScreen,document:o.Xblnr,view:"EstadoCuenta"},true)}else{console.log("sin campo lifnr_aportacion");a.show("Sin aportaciÃ³n")}}}else{var y="GroupedTotales>";var C=[t,this._nextCrumb(l)].join("/");this._setAggregation(y+C);console.log("new spath",C)}},____handleSelection:function(e){console.log("on condepto select");var t=e.getParameter("listItem").getBindingContextPath();console.log(t);var o=t.split("/");var r=t.split("/").reverse()[1];var a=o[o.length-2];console.log("current path",a);if(r!==this.aCrumbs[this.aCrumbs.length-1]){var l=this.byId("breadcrumb");var n=o[o.length-2];var i=this.aCrumbs.indexOf(n)+1;console.log("currentNOde",i);var u=new s({text:"{GroupedTotales>name}",press:[t+"/"+this.aCrumbs[i],this.onBreadcrumbPress,this]});u.bindElement({path:"GroupedTotales>"+t});l.addLink(u)}if(a===this.aCrumbs[this.aCrumbs.length-1]){var d={};console.log("on documnt press",e);console.log(t);let o=this.getOwnerComponent().getModel("GroupedTotales").getProperty(t);var p=this.getOwnerComponent().getModel("GroupedTotales").getProperty("/Bukrs");var c=o.Budat;var g=c.substr(0,4)?c.substr(0,4):"";console.log(this.getOwnerComponent().getModel("totales"));var h=o.Tcode;console.log(p,g,h);var b=o.Belnr;var m=["MEB4","WLF4","MEB2","MEB0","WLF2","ZMMFILACUERDO","WFL5"];var v=["Z_APORTACIONES"];if(m.includes(h)&&b.startsWith("510")||h==""&&!(b.startsWith("1700")&&o.Xblnr)){console.log("on detailAcuerdosAS");this.getOwnerComponent().getRouter().navTo("detailAcuerdosAS",{layout:sap.f.LayoutType.MidColumnFullScreen,document:o.Belnr,sociedad:p,ejercicio:g,doc:o.Xblnr?o.Xblnr:"NA"},true)}else if(v.includes(h)||b.startsWith("1700")&&o.Xblnr){console.log("on detailAportacionesAS");this.getOwnerComponent().getRouter().navTo("detailAportacionesAS",{layout:sap.f.LayoutType.MidColumnFullScreen,document:o.Xblnr,view:"EstadoCuenta"},true)}}else{var f="GroupedTotales>";var y=[t,this._nextCrumb(a)].join("/");this._setAggregation(f+y);console.log("new spath",y)}},onBreadcrumbPress:function(e,t){var o=e.getSource();var r=this.byId("breadcrumb");var s=r.indexOfLink(o);var a=r.getLinks().slice(s+1);if(a.length){a.forEach(function(e){e.destroy()});this._setAggregation(t)}},clearFilters:function(){this.getView().byId("dateRange").setValue("")},paginar:function(e){let t=parseInt(this.getOwnerComponent().getModel("totales").getProperty("/Detalles/results/length"),10);let o=parseInt(e.getKey(),10);this.paginateValue(e,"totales","/Detalles")},buildExportTable:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=this.formatData(this.getOwnerComponent().getModel("totales").getProperty("/Detalles/results"),e);console.log(t);var o=[{label:e.getProperty("/aportaciones.concepto").toUpperCase(),property:["IdNumTipomov","DescTipomov"],template:"{0} {1}",width:31},{label:e.getProperty("/state.statusUPC").toUpperCase(),property:"status",width:15},{label:e.getProperty("/state.xlsx.folio").toUpperCase(),property:"Folio",width:15},{label:e.getProperty("/state.xlsx.sucursal").toUpperCase(),property:"Sucursal",width:15},{label:e.getProperty("/state.folioUPC").toUpperCase(),property:"Belnr",width:20},{label:e.getProperty("/state.referenceUPC").toUpperCase(),property:"Xblnr",width:20},{label:e.getProperty("/state.typeDocUPC").toUpperCase(),property:"Ltext",width:22},{label:e.getProperty("/state.date").toUpperCase(),property:"Budat",width:22},{label:e.getProperty("/clarifications.expirationDate").toUpperCase(),property:"FechaTesoreria",width:22},{label:e.getProperty("/state.amount").toUpperCase(),property:"Wrbtr",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:15},{label:e.getProperty("/reporte.headerTitulo").toUpperCase(),property:"MCondicion",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:32},{label:e.getProperty("/state.bloqueado").toUpperCase(),property:"DescripcionBloqueo",width:32}];this.buildExcelSpreadSheet(o,t,"Estado de cuenta.xlsx")},formatData:function(e,t){e.forEach(function(e){if(e.Pendt===true){e.status=t.getProperty("/state.xlsx.statusPend")}else if(e.Belnr===e.Augbl){e.status=t.getProperty("/state.xlsx.statusPago")}else{e.status=t.getProperty("/state.xlsx.statusCont")}if(e.MCondicion!=="0.00"){e.MCondicion="-"+e.MCondicion}});return e},onMarkerPress:function(e){},formatDateTime:(e,t,o)=>{if(!e instanceof Date&&typeof e!=="string"&&typeof format!=="string")return false;let r={format:t,pattern:t};let s=sap.ui.core.format.DateFormat.getDateTimeInstance(r);if(e instanceof Date)return s.format(e);if(typeof e=="string"){let t;switch(String(o).toLowerCase()){case"yyyymmdd":let o=[];o.push(e.substring(0,4));o.push(e.substring(4,2));o.push(e.substring(6,2));t=new Date(o[0],o[1],o[2]);break;default:return false;break}return s.format(t)}},onDocumentDevolucionPress:function(e){var t=e.getSource().getBindingContext("GroupedTotales").getPath();let o=this.getOwnerComponent().getModel("GroupedTotales").getProperty(t);console.log(o);var r=this.getOwnerComponent().getModel("GroupedTotales").getProperty("/Lifnr");this.getOwnerComponent().getRouter().navTo("detailDevoEstadoCuenta",{layout:sap.f.LayoutType.MidColumnFullScreen,xblnr:o.Foliodescuento,lifnr:r,ebeln:o.Ebeln,suc:o.Sucursal},true)},onDocumentPress:function(e){var t=e.getSource().getBindingContext("GroupedTotales").getPath();let o=this.getOwnerComponent().getModel("GroupedTotales").getProperty(t);var r=this.getOwnerComponent().getModel("GroupedTotales").getProperty("/Bukrs");var s=o.Budat;var l=s.substr(0,4)?s.substr(0,4):"";console.log(this.getOwnerComponent().getModel("totales"));var n=o.Tcode;console.log(r,l,n);var i=o.Belnr;var u=["MEB4","WLF4","MEB2","MEB0","WLF2","ZMMFILACUERDO","WFL5"];var d=["Z_APORTACIONES"];var p=["ZMM_ACUERDOS_LIQUI"];var c=o.Boart;var g=["ZD33","ZD34","ZM33","ZM34"];console.log(o);if(u.includes(n)&&i.startsWith("510")||n==""&&!(i.startsWith("1700")&&o.Xblnr)){console.log("on detailAcuerdosAS");if(g.includes(c)){this.getOwnerComponent().getRouter().navTo("detailAcuerdosECNS",{layout:sap.f.LayoutType.TwoColumnsMidExpanded,document:o.Belnr,sociedad:r,ejercicio:l,doc:o.Xblnr?o.Xblnr:"NA"},true)}else{this.getOwnerComponent().getRouter().navTo("detailAcuerdosAS",{layout:sap.f.LayoutType.TwoColumnsMidExpanded,document:o.Belnr,sociedad:r,ejercicio:l,doc:o.Xblnr?o.Xblnr:"NA"},true)}}else if(d.includes(n)||i.startsWith("1700")&&o.Xblnr){console.log("on detailAportacionesAS");if(o.LifnrAportacion!==""){console.log("on detailAportacionesAS1");this.getOwnerComponent().getRouter().navTo("detailAportacionesAS",{layout:sap.f.LayoutType.MidColumnFullScreen,document:o.Foliodescuento,view:"EstadoCuenta",belnr:i,bukrs:r,gjahr:l},true)}else{a.show("Sin detalle")}}else if(n==="ZMM_ACUERDOS_LIQUI"){console.log("on boletin vtz");console.log(i,r,l);this.getOwnerComponent().getRouter().navTo("BoletinVtaDetailPolizasE",{layout:sap.f.LayoutType.MidColumnFullScreen,document:i,company:r,year:l},true)}else if(n==="ZFI_INVLOAD"){console.log("HolaJuan");console.log(r);console.log(i);this.getOwnerComponent().getRouter().navTo("AcuerdosEC",{layout:sap.f.LayoutType.TwoColumnsMidExpanded,document:i,sociedad:r},true)}},onPress:function(e){console.info(e);var t=e.getSource().getBindingContext("GroupedTotales").getPath();console.log(t);let o=this.getOwnerComponent().getModel("GroupedTotales").getProperty(t);let r=this.getConfigModel().getProperty("/supplierInputKey");console.log(o);if(o.Xblnr==""){return}var s=o.Xblnr;var a=s.replace(/[0-9]/g,"");var l=a.replace("-","");var n=s.replace(/\D/g,"");console.log(a);console.log(l);console.log(n);this.getOwnerComponent().getRouter().navTo("EstadoCuentaReporte",{layout:sap.f.LayoutType.MidColumnFullScreen,document:n,proveedor:r,serie:a,fecha:o.Budat},false)},hasReport:function(e){return Math.abs(e)>0?true:false}})});
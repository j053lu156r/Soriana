sap.ui.define(["jquery.sap.global","sap/ui/core/Fragment","demo/controllers/BaseController","sap/m/UploadCollectionParameter","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/m/MessageBox","sap/ui/export/library","sap/ui/export/Spreadsheet","sap/ui/core/routing/Router","demo/models/BaseModel","sap/f/library"],function(e,t,i,o,r,s,a,l,n,d){"use strict";var p=n.EdmType;var u=new this.MejorCond;return i.extend("demo.controllers.Statement.AcuerdosE",{onInit:function(){this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("AcuerdosEC").attachPatternMatched(this._onDocumentMatched,this)},searchData:function(){let e=this;var t=[];t.push(new sap.ui.model.Filter({path:"Lifnr",operator:sap.ui.model.FilterOperator.EQ,value1:e.getConfigModel().getProperty("/supplierInputKey")}));t.push(new sap.ui.model.Filter({path:"Belnr",operator:sap.ui.model.FilterOperator.EQ,value1:e._document}));var i="ZOSP_ACUERDOS_SRV";var o="AcuerdosGralSet";var r="";var s=t;var a="";sap.ui.core.BusyIndicator.show();e._GEToDataV2(i,o,s,r,a).then(function(t){sap.ui.core.BusyIndicator.hide();var i=t.data.results;console.log(i);for(var o=0;o<i.length;o++){i[o].Fecca=i[o].Fecca.split("T")[0]}if(i.length>0){e.getView().byId("idEbeln").setVisible(false);e.getView().byId("idMatnr").setVisible(false);e.getView().byId("idCanti").setVisible(false);e.getView().byId("idPvmat").setVisible(false);e.getView().byId("Cumat").setVisible(false);e.getView().byId("idCargo").setVisible(false);var r=new sap.ui.model.json.JSONModel(i);e.getView().setModel(r,"ECuentaAcl")}else{e.searchData2()}})},searchData2:function(){let e=this;var t=[];t.push(new sap.ui.model.Filter({path:"Lifnr",operator:sap.ui.model.FilterOperator.EQ,value1:e.getConfigModel().getProperty("/supplierInputKey")}));t.push(new sap.ui.model.Filter({path:"Belnr",operator:sap.ui.model.FilterOperator.EQ,value1:e._document}));var i="ZOSP_ACUERDOS_SRV";var o="AcuerdosNserSet";var r="";var s=t;var a="";sap.ui.core.BusyIndicator.show();e._GEToDataV2(i,o,s,r,a).then(function(t){sap.ui.core.BusyIndicator.hide();var i=t.data.results;console.log(i);for(var o=0;o<i.length;o++){i[o].Fecca=i[o].Fecca.split("T")[0]}if(i.length>0){e.getView().byId("idFolio").setVisible(false);e.getView().byId("idBase").setVisible(false);e.getView().byId("idDesct").setVisible(false);e.getView().byId("idPrdes").setVisible(false);var r=new sap.ui.model.json.JSONModel(i);e.getView().setModel(r,"migoModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/state.Error"))}})},onExit:function(){let e=this;e.getView().byId("idEbeln").setVisible(true);e.getView().byId("idMatnr").setVisible(true);e.getView().byId("idCanti").setVisible(true);e.getView().byId("idPvmat").setVisible(true);e.getView().byId("Cumat").setVisible(true);e.getView().byId("idCargo").setVisible(true);e.getView().byId("idTotca").setVisible(true);e.getView().byId("idFolio").setVisible(true);e.getView().byId("idBase").setVisible(true);e.getView().byId("idDesct").setVisible(true);e.getView().byId("idPrdes").setVisible(true)},clearFilters:function(){},buildExportTable:function(){var e,t,i,o,r,s=this;if(!s._oTable){s._oTable=this.byId("aclaracionesList")}r=s._oTable;t=r.getBinding().oList;e=s.createColumnConfig();i={workbook:{columns:e,hierarchyLevel:"Level"},dataSource:t,fileName:"Estado de Cuenta",worker:false};o=new d(i);o.build().finally(function(){o.destroy()})},genereteRowAction:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=this.byId("tableVisor");var i=t.getRowActionTemplate();if(i){i.destroy();i=null}i=new RowAction({items:[new RowActionItem({icon:"sap-icon://open-command-field",text:e.getProperty("/global.view"),press:e=>this.onPress(e)})]});t.setRowActionTemplate(i);t.setRowActionCount(2)},createColumnConfig:function(){var e=this;var t=e.getView().getModel("migoModel").getData(),i=[];var o=this.getOwnerComponent().getModel("appTxts");if(e.getView().byId("idLifnr").getVisible()){i.push({label:o.getProperty("/stateA.proveedor"),type:p.String,property:"Lifnr"})}if(e.getView().byId("idBelnr").getVisible()){i.push({label:o.getProperty("/stateA.documento"),type:p.String,property:"Belnr"})}if(e.getView().byId("idConve").getVisible()){i.push({label:o.getProperty("/stateA.convenio"),type:p.String,property:"Conve"})}if(e.getView().byId("idWerks").getVisible()){i.push({label:o.getProperty("/stateA.centro"),type:p.String,property:"Werks"})}if(e.getView().byId("idFolio").getVisible()){i.push({label:o.getProperty("/stateA.folio"),type:p.String,property:"Folio"})}if(e.getView().byId("idEbeln").getVisible()){i.push({label:o.getProperty("/stateA.pedido"),type:p.String,property:"Ebeln"})}if(e.getView().byId("idBase").getVisible()){i.push({label:o.getProperty("/stateA.base"),type:p.String,property:"Base"})}if(e.getView().byId("idMatnr").getVisible()){i.push({label:o.getProperty("/stateA.material"),type:p.String,property:"Matnr"})}if(e.getView().byId("idCanti").getVisible()){i.push({label:o.getProperty("/stateA.cantidad"),type:p.String,property:"Canti"})}if(e.getView().byId("idPvmat").getVisible()){i.push({label:o.getProperty("/stateA.pvMat"),type:p.String,property:"Pvmat"})}if(e.getView().byId("Cumat").getVisible()){i.push({label:o.getProperty("/stateA.cuMat"),type:p.String,property:"Cumat"})}if(e.getView().byId("idDesct").getVisible()){i.push({label:o.getProperty("/stateA.descto"),type:p.Number,property:"Desct"})}if(e.getView().byId("idCargo").getVisible()){i.push({label:o.getProperty("/stateA.cargo"),type:p.Number,property:"Cargo"})}if(e.getView().byId("idIeps").getVisible()){i.push({label:o.getProperty("/stateA.ieps"),type:p.Number,property:"Ieps"})}if(e.getView().byId("idIva").getVisible()){i.push({label:o.getProperty("/reporte.iva"),type:p.Number,property:"Iva"})}if(e.getView().byId("idPrdes").getVisible()){i.push({label:o.getProperty("/stateA.pDescto"),type:p.Number,property:"Prdes"})}if(e.getView().byId("idFecca").getVisible()){i.push({label:o.getProperty("/stateA.fecCargo"),type:p.String,property:"Fecca"})}if(e.getView().byId("idTotca").getVisible()){i.push({label:o.getProperty("/stateA.totCargo"),type:p.String,property:"Totca"})}return i},_onDocumentMatched:function(e){this._document=e.getParameter("arguments").document||this._document||"0";this.sociedad=e.getParameter("arguments").sociedad||this._proveedor||"0";this.searchData()},handleFullScreen:function(){var e=this.getOwnerComponent().getHelper().getNextUIState(2);this.bFocusFullScreenButton=true;var t=this.oModel.getProperty("/actionButtonsInfo/midColumn/fullScreen");this.getOwnerComponent().getRouter().navTo("AcuerdosEC",{layout:t,document:this._document,sociedad:this.sociedad},true)},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/exitFullScreen");this.oRouter.navTo("EstadoCuenta",{layout:e,document:this._document,sociedad:this.sociedad})},handleClose:function(){console.log("on hanlde close");this.onExit();var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/closeColumn");this.oRouter.navTo("EstadoCuenta",{})}})});
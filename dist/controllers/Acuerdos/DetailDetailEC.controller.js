sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController"],function(e,t){"use strict";var o=new this.Acuerdos;return t.extend("demo.controllers.Acuerdos.DetailDetailEC",{onInit:function(){var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailDetailAcuEC").attachPatternMatched(this._onDocumentMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this)},handleItemPress:function(e){},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("detailDetailAcuEC",{layout:e,document:this._document,sociedad:this._sociedad,ejercicio:this._ejercicio,doc:this._doc,tda:this._tda})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("detailDetailAcuEC",{layout:e,document:this._document,sociedad:this._sociedad,ejercicio:this._ejercicio,doc:this._doc,tda:this._tda})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/closeColumn");this.oRouter.navTo("detailAcuerdosAS",{layout:e,document:this._document,sociedad:this._sociedad,ejercicio:this._ejercicio,doc:this._doc})},_onDocumentMatched:function(t){this._sociedad=t.getParameter("arguments").sociedad||this._sociedad||"0";this._document=t.getParameter("arguments").document||this._document||"0";this._ejercicio=t.getParameter("arguments").ejercicio||this._ejercicio||"0";this._doc=t.getParameter("arguments").doc||this._doc||"0";this._tda=t.getParameter("arguments").tda||this._tda||"0";var n={Sociedad:this._sociedad,Documento:this._document,Ejercicio:this._ejercicio,Tienda:this._tda};this.getOwnerComponent().setModel(new e(n),"acuHeadDetDetModel");var c="AcuerdosSet?$expand=AcuDetDet&$filter=";c+="Sociedad eq '"+this._sociedad+"'";c+=" and Documento eq '"+this._document+"'";c+=" and Ejercicio eq '"+this._ejercicio+"'";c+=" and Tienda eq '"+this._tda+"'";this.getView().byId("AcuerdosDetDet").setBusy(true);o.getJsonModelAsync(c,function(t,o){var n=t.getProperty("/results/0");if(n!=null){var c=n.AcuDetDet.results.reduce((e,t)=>+e+(+t["Compra"]||0),0);var i=n.AcuDetDet.results.reduce((e,t)=>+e+(+t["Descuento"]||0),0);var r=n.AcuDetDet.results.reduce((e,t)=>+e+(+t["IVA"]||0),0);var s={TotCompra:Number(c.toFixed(2)),TotDescto:Number(i.toFixed(2)),TotIVA:Number(r.toFixed(2))};o.getOwnerComponent().setModel(new e(s),"acuTotDetDetModel");o.getOwnerComponent().setModel(new e(n),"AcuDetDetHdr");o.paginate("AcuDetDetHdr","/AcuDetDet",1,0)}o.getView().byId("AcuerdosDetDet").setBusy(false)},function(e){e.getView().byId("AcuerdosDetDet").setBusy(false)},this)},buildExportTable:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=[{name:e.getProperty("/acuerdos.detConv"),template:{content:"{Convenio}"}},{name:e.getProperty("/acuerdos.detCveMov"),template:{content:"{CveMov}"}},{name:e.getProperty("/acuerdos.detFolio"),template:{content:"{Folio}"}},{name:e.getProperty("/acuerdos.detFact"),template:{content:"{Factura}"}},{name:e.getProperty("/acuerdos.detTda"),template:{content:"{Tienda}"}},{name:e.getProperty("/acuerdos.detComp"),template:{content:"{Compra}"}},{name:e.getProperty("/acuerdos.detDesc"),template:{content:"{Descuento}"}},{name:e.getProperty("/acuerdos.detIVA"),template:{content:"{IVA}"}},{name:e.getProperty("/acuerdos.detPDesc"),template:{content:"{PDesc}"}}];this.exportxls("AcuDetDetHdr","/AcuDetDet/results",t)}})});
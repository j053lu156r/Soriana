sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/ui/core/mvc/Controller","sap/m/MessageToast","jquery.sap.global","demo/models/BaseModel"],function(e,t,r,s,a){"use strict";var n=new this.ACEscalas;return t.extend("demo.controllers.acuerdosEscalas.detailEscalasCentro",{onInit:function(){var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailEscalasCentro").attachPatternMatched(this._onDocumentMatched,this)},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("detailEscalasCentro",{layout:e,bukrs:this._bukrs,belnr:this._belnr,gjahr:this._gjahr,lifnr:this._lifnr,werks:this._werks,name:this._name})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("detailEscalasCentro",{layout:e,bukrs:this._bukrs,belnr:this._belnr,gjahr:this._gjahr,lifnr:this._lifnr,werks:this._werks,name:this._name})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");e=sap.f.LayoutType.TwoColumnsMidExpanded;this.oRouter.navTo("summarizedEscalas",{layout:e,bukrs:this._bukrs,belnr:this._belnr,gjahr:this._gjahr,lifnr:this._lifnr},true)},_onDocumentMatched:function(t){this._bukrs=t.getParameter("arguments").bukrs||this._bukrs||"0";this._belnr=t.getParameter("arguments").belnr||this._belnr||"0";this._gjahr=t.getParameter("arguments").gjahr||this._gjahr||"0";this._lifnr=t.getParameter("arguments").lifnr||this._lifnr||"0";this._werks=t.getParameter("arguments").werks||this._werks||"0";this._name=t.getParameter("arguments").name||this._name||"";var r={bukrs:this._bukrs,belnr:this._belnr,gjahr:this._gjahr,lifnr:this._lifnr,werks:this._werks,name:this._name};this.getOwnerComponent().setModel(new e(r),"scalDetModel");var s="ScaleSet?$filter=bukrs eq '"+this._bukrs+"' and belnr eq '"+this._belnr+"' and gjahr eq '"+this._gjahr+"' and lifnr eq '"+this._lifnr+"' and werks eq '"+this._werks+"'";this.getView().byId("scalDetTable").setBusy(true);n.getJsonModelAsync(s,function(e,t){var r=e.getProperty("/results");if(r!=null){var s=r.reduce((e,t)=>+e+(+t["dmbtr"]||0),0);var a=r.reduce((e,t)=>+e+(+t["zboni"]||0),0);var n=r.reduce((e,t)=>+e+(+t["ziva"]||0),0);var o=r.reduce((e,t)=>+e+(+t["zieps"]||0),0);var l=r.reduce((e,t)=>+e+(+t["stotal"]||0),0);if(r.length>0){var i=r[0].waers}var u={totImporte:Number(s.toFixed(2)),TotDescto:Number(a.toFixed(2)),totIVA:Number(n.toFixed(2)),totIEPS:Number(o.toFixed(2)),TotStot:Number(l.toFixed(2)),currCode:i};t.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(u),"scalDetTotModel");t.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(r),"scalDetDta")}t.getView().byId("scalDetTable").setBusy(false)},function(e){e.getView().byId("scalDetTable").setBusy(false)},this)},buildExportTable:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=[{name:e.getProperty("/ACEscalas.plant"),template:{content:"{werks}"}},{name:e.getProperty("/ACEscalas.arrangement"),template:{content:"{knuma}"}},{name:e.getProperty("/ACEscalas.matdoc"),template:{content:"{mblnr}"}},{name:e.getProperty("/ACEscalas.matdocYear"),template:{content:"{mjahr}"}},{name:e.getProperty("/ACEscalas.movClass"),template:{content:"{bwart}"}},{name:e.getProperty("/ACEscalas.reference"),template:{content:"{xblnr}"}},{name:e.getProperty("/ACEscalas.amount"),template:{content:"{dmbtr}"}},{name:e.getProperty("/ACEscalas.Descount"),template:{content:"{zboni}"}},{name:e.getProperty("/ACEscalas.IVA"),template:{content:"{ziva}"}},{name:e.getProperty("/ACEscalas.IEPS"),template:{content:"{zipes}"}},{name:e.getProperty("/ACEscalas.subtotal"),template:{content:"{stotal}"}}];this.exportxls("scalDetDta","/",t)}})});
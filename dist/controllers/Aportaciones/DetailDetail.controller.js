sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/m/PDFViewer","sap/m/MessageBox"],function(e,t,o,i){"use strict";var n=new this.Aportaciones;return t.extend("demo.controllers.Aportaciones.DetailDetail",{onInit:function(){this._pdfViewer=new o;this.getView().addDependent(this._pdfViewer);var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailDetailAporta").attachPatternMatched(this._onDocumentMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this)},handleItemPress:function(e){},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("detailDetailAporta",{layout:e,folio:this._folio,concepto:this._concepto,gerencia:this._gerencia,importe:this._importe})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("detailDetailAporta",{layout:e,folio:this._folio,concepto:this._concepto,gerencia:this._gerencia,importe:this._importe})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/closeColumn");this.oRouter.navTo("detailAportaciones",{layout:e,folio:this._folio,concepto:this._concepto,gerencia:this._gerencia,importe:this._importe})},_onDocumentMatched:function(t){this._folio=t.getParameter("arguments").folio||this._folio||"0";this._concepto=t.getParameter("arguments").concepto||this.concepto||"0";this._gerencia=t.getParameter("arguments").gerencia||this.gerencia||"0";this._importe=t.getParameter("arguments").importe||this.importe||"0";var o="AportaSet?$expand=AportaDet&$filter=IOption eq '1'";if(this._folio!=""&&this._folio!=null){o+=" and IFolio eq '"+this._folio+"'"}n.getJsonModelAsync(o,function(t,o){var i=t.getProperty("/results/0");if(i!=null){o.getOwnerComponent().setModel(new e(i.AportaDet.results[0]),"AportaDetDet")}},function(e){},this)},onPressPDF:function(){var e=this.getOwnerComponent().getModel("AportaDetDet");var t=e.getData();var o="/sap/opu/odata/sap/ZOSP_APORTA_SRV/";var i=o+"AportaFilesSet('"+t.Uuid+"')/$value";this._pdfViewer.setSource(i);this._pdfViewer.setTitle("CFDI");this._pdfViewer.open()},onPressXML:function(){var e=this.getOwnerComponent().getModel("AportaDetDet");var t=e.getData();var o="/sap/opu/odata/sap/ZOSP_APORTA_SRV/";var e=new sap.ui.model.odata.ODataModel(o);e.read("/AportaFilesSet('XML"+t.Uuid+"')/$value",{method:"GET",success:function(e,o){let i=t.Uuid;let n="application/xml";let r=o.body;sap.ui.core.util.File.save(r,i,"xml",n)},error:function(e){i.error(e.message)}})}})});
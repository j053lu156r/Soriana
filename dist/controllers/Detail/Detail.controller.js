sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/ui/core/mvc/Controller"],function(e,t){"use strict";var n=new this.EnvioCfdi;return t.extend("demo.controllers.Detail.Detail",{onInit:function(){var e=this.getView().byId("exitFullScreenBtn"),t=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailCfdi").attachPatternMatched(this._onDocumentMatched,this);[e,t].forEach(function(e){e.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;e.focus()}}.bind(this)})},this)},handleItemPress:function(e){var t=this.getOwnerComponent().getHelper().getNextUIState(2),n=e.getSource().getBindingContext("tableItemsCfdi").getPath(),o=n.split("/").slice(-1).pop()},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/fullScreen");this.oRouter.navTo("detailCfdi",{layout:e,document:this._document,year:this._year})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/exitFullScreen");this.oRouter.navTo("detailCfdi",{layout:e,document:this._document,year:this._year})},handleClose:function(){var e=this.oModel.getProperty("/actionButtonsInfo/midColumn/closeColumn");this.oRouter.navTo("masterCfdi",{layout:e})},_onDocumentMatched:function(t){this._document=t.getParameter("arguments").document||this._document||"0";this._year=t.getParameter("arguments").year||this._year||"0";var o="/HeaderCFDISet?$expand=EDOCDTLNAV,EDOCHDRNAV&$filter=IOption eq '2' and IBelnr eq '"+this._document+"' and IPeriodo eq '"+this._year+"'";var r=n.getJsonModel(o);var a=r.getProperty("/results/0");this.getOwnerComponent().setModel(new e(a),"tableDetailMoves");this.paginate("tableDetailMoves","/EDOCDTLNAV",1,0)},getOrder:function(e){var t=e.getSource().getProperty("text");var n=this.getOwnerComponent().getHelper().getNextUIState(3);this.oRouter.navTo("detailOrders",{layout:n.layout,document:t})},buildExcel:function(){var e=this.getOwnerComponent().getModel("appTxts");let t=this.getOwnerComponent().getModel("tableDetailMoves");var n=[{name:e.getProperty("/sendInv.recepNumberUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Xblnr")}},{name:e.getProperty("/global.yearUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Gjahr")}},{name:e.getProperty("/sendInv.documentUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Belnr")+" - "+t.getProperty("/EDOCHDRNAV/results/0/Gjahr")}},{name:e.getProperty("/sendInv.purchaseOrderUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Ebeln")}},{name:e.getProperty("/sendInv.amountUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Dmbtr")}},{name:e.getProperty("/sendInv.referenceUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Bktxt")}},{name:e.getProperty("/sendInv.dateUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Budat")}},{name:e.getProperty("/sendInv.taxUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Impuesto")}},{name:e.getProperty("/sendInv.vendorUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Sociedad")}},{name:e.getProperty("/sendInv.totalUPC"),template:{content:t.getProperty("/EDOCHDRNAV/results/0/Total")}},{name:e.getProperty("/sendInv.positionUPC"),template:{content:"{Ebelp}"}},{name:e.getProperty("/sendInv.barcodeUPC"),template:{content:"{Ean11}"}},{name:e.getProperty("/sendInv.descriptionUPC"),template:{content:"{Txz01}"}},{name:e.getProperty("/sendInv.qtyUPC"),template:{content:"{Bpmng}"}},{name:e.getProperty("/global.unitUC"),template:{content:"{Bprme}"}},{name:e.getProperty("/sendInv.unitPriceUPC"),template:{content:"{Unitp}"}},{name:e.getProperty("/sendInv.positionAmountUPC"),template:{content:"{Dmbtr}"}},{name:e.getProperty("/global.currencyUC"),template:{content:"{Waers}"}},{name:e.getProperty("/sendInv.packCapUPC"),template:{content:"{Emp_cap}"}},{name:e.getProperty("/global.unitUC"),template:{content:"{Packu}"}},{name:e.getProperty("/sendInv.storeUPC"),template:{content:"{Werks}"}},{name:e.getProperty("/sendInv.storeUPC"),template:{content:"{Centro}"}}];this.exportxls("tableDetailMoves","/EDOCDTLNAV/results",n)}})});
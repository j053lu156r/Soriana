sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/ui/core/mvc/Controller","sap/m/MessageToast","jquery.sap.global","demo/models/BaseModel"],function(e,t,o,r,a){"use strict";var n=new this.Polizas;return t.extend("demo.controllers.BoletinVta.DetailCargoMaterialCP",{onInit:function(){this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailCargoMatsBoletinVtaCP").attachPatternMatched(this._onDocumentMatched,this)},handleItemPress:function(e){},handleFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("detailCargoMatsBoletinVtaCP",{layout:e,Company:this._Company,Forum:this._Forum,ForumDesc:this._ForumDesc,Vendor:this._Vendor,Agreement:this._Agreement,DateCreated:this._DateCreated,document:this._document,year:this._year,fecha:this._fecha,documentO:this._documentO,yearO:this._yearO})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var e=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("detailCargoMatsBoletinVtaCP",{layout:e,Company:this._Company,Forum:this._Forum,ForumDesc:this._ForumDesc,Vendor:this._Vendor,Agreement:this._Agreement,DateCreated:this._DateCreated,document:this._document,year:this._year,fecha:this._fecha,documentO:this._documentO,yearO:this._yearO})},handleClose:function(){var e=this.getOwnerComponent().getHelper().getNextUIState(3);this.oRouter.navTo("detailCargoBoletinVtaCP",{layout:e.layout,Company:this._Company,Vendor:this._Vendor,Agreement:this._Agreement,DateCreated:this._DateCreated,document:this._document,year:this._year,fecha:this._fecha,documentO:this._documentO,yearO:this._yearO})},onBack:function(){window.history.go(-1)},_onDocumentMatched:function(t){this._Company=t.getParameter("arguments").Company||this._Company||"0";this._Vendor=t.getParameter("arguments").Vendor||this._Vendor||"0";this._Agreement=t.getParameter("arguments").Agreement||this._Agreement||"0";this._DateCreated=t.getParameter("arguments").DateCreated||this._DateCreated||"0";this._document=t.getParameter("arguments").document||this._document||"0";this._year=t.getParameter("arguments").year||this._year||"0";this._Forum=t.getParameter("arguments").Forum||this._Forum||"0";this._ForumDesc=t.getParameter("arguments").ForumDesc||this._ForumDesc||"0";this._fecha=t.getParameter("arguments").fecha||this._fecha||"0";this._documentO=t.getParameter("arguments").documentO||this._documentO||"0";this._yearO=t.getParameter("arguments").yearO||this._yearO||"0";var o={Company:this._Company,Vendor:this._Vendor,Agreement:this._Agreement,DateCreated:this._DateCreated,Forum:this._Forum,ForumDesc:this._ForumDesc};this.getOwnerComponent().setModel(new e(o),"debitDetMatModel");var r="debitByMaterialSet?$filter=Company eq '"+this._Company+"' and Forum eq '"+this._Forum+"' and Agreement eq '"+this._Agreement+"' and Vendor eq '"+this._Vendor+"' and DateCreated eq '"+this._DateCreated+"' and Document eq '"+this._document+"'";this.getView().byId("debitMatTable").setBusy(true);n.getJsonModelAsync(r,function(e,t){var o=e.getProperty("/results");if(o!=null){var r=o.reduce((e,t)=>+e+(+t["Cost"]||0),0);var a=o.reduce((e,t)=>+e+(+t["Price"]||0),0);var n=o.reduce((e,t)=>+e+(+t["Bonus"]||0),0);var i=o.reduce((e,t)=>+e+(+t["Tax"]||0),0);var s=o.reduce((e,t)=>+e+(+t["Ieps"]||0),0);var m=o.reduce((e,t)=>+e+(+t["Discount"]||0),0);m=o[0].Discount;var u=o.reduce((e,t)=>+e+(+t["Qty"]||0),0);var d=o.reduce((e,t)=>+e+(+t["Total"]||0),0);var l={TotCost:Number(r.toFixed(2)),TotPrice:Number(a.toFixed(2)),TotBonus:Number(n.toFixed(2)),TotIVA:Number(i.toFixed(2)),TotIEPS:Number(s.toFixed(2)),TotDiscount:Number(m),Total:Number(d.toFixed(2)),TotQty:Number(u.toFixed(0)),Promotion:o[0].Promotion};t.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(l),"debTotMatModel");t.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(o),"debitMatDet")}t.getView().byId("debitMatTable").setBusy(false)},function(e){e.getView().byId("debitMatTable").setBusy(false)},this)},buildExportTable:function(){var e=this.getOwnerComponent().getModel("appTxts");var t=[{name:e.getProperty("/foliosCap.promocion"),template:{content:"{Promotion}"}},{name:e.getProperty("/PolizadetCargo.Agreement"),template:{content:"{Agreement}"}},{name:e.getProperty("/PolizadetCargo.Centro"),template:{content:"{Forum}"}},{name:e.getProperty("/PolizadetCargo.CentroNombre"),template:{content:"{ForumDescrition}"}},{name:e.getProperty("/PolizadetCargo.Material"),template:{content:"{Material}"}},{name:e.getProperty("/PolizadetCargo.MatDescription"),template:{content:"{MatDescription}"}},{name:e.getProperty("/PolizadetCargo.bonus"),template:{content:"{Bonus}"}},{name:e.getProperty("/PolizadetCargo.Qty"),template:{content:"{Qty}"}},{name:e.getProperty("/PolizadetCargo.discount"),template:{content:"{Discount}"}},{name:e.getProperty("/PolizadetCargo.IEPS"),template:{content:"{Ieps}"}},{name:e.getProperty("/PolizadetCargo.IVA"),template:{content:"{Tax}"}},{name:e.getProperty("/PolizadetCargo.total"),template:{content:"{Total}"}}];this.exportxls("debitMatDet","/",t)}})});
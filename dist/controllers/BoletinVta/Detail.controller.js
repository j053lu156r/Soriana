sap.ui.define(["sap/ui/model/json/JSONModel","demo/controllers/BaseController","sap/ui/core/mvc/Controller","sap/m/MessageToast","jquery.sap.global","demo/models/BaseModel"],function(t,e,o,n,i){"use strict";var r=new this.ACcapturados;return e.extend("demo.controllers.BoletinVta.Detail",{onInit:function(){var t=this.getView().byId("exitFullScreenBtn"),e=this.getView().byId("enterFullScreenBtn");this.oRouter=this.getOwnerComponent().getRouter();this.oModel=this.getOwnerComponent().getModel();this.oRouter.getRoute("detailBoletinVta").attachPatternMatched(this._onDocumentMatched,this);[t,e].forEach(function(t){t.addEventDelegate({onAfterRendering:function(){if(this.bFocusFullScreenButton){this.bFocusFullScreenButton=false;t.focus()}}.bind(this)})},this)},handleItemPress:function(t){},handleFullScreen:function(){this.bFocusFullScreenButton=true;var t=this.oModel.getProperty("/actionButtonsInfo/endColumn/fullScreen");this.oRouter.navTo("detailBoletinVta",{layout:t,promotion:this._promotion,vendor:this._vendor,promDescription:this._promDesciption,IntenalClass:this._IntenalClass,plant:this._plant,plantName:this._plantName,origin:this._origin})},handleExitFullScreen:function(){this.bFocusFullScreenButton=true;var t=this.oModel.getProperty("/actionButtonsInfo/endColumn/exitFullScreen");this.oRouter.navTo("detailBoletinVta",{layout:t,promotion:this._promotion,vendor:this._vendor,promDescription:this._promDesciption,IntenalClass:this._IntenalClass,plant:this._plant,plantName:this._plantName,origin:this._origin})},handleClose:function(){this.oRouter.navTo("detailBoletinVtaCentros",{layout:sap.f.LayoutType.TwoColumnsMidExpanded,promotion:this._promotion,vendor:this._vendor,promDescription:this._promDesciption,IntenalClass:this._IntenalClass,origin:this._origin})},_onDocumentMatched:function(e){this._promotion=e.getParameter("arguments").promotion||this._promotion||"0";this._vendor=e.getParameter("arguments").vendor||this._vendor||"0";this._promDesciption=e.getParameter("arguments").promDescription||this._promDesciption||"0";this._IntenalClass=e.getParameter("arguments").IntenalClass||this._IntenalClass||"0";this._plant=e.getParameter("arguments").plant||this._plant||"0";this._plantName=e.getParameter("arguments").plantName||this._plantName||"0";this._origin=e.getParameter("arguments").origin||this._origin||"0";var o={promotion:this._promotion,vendor:this._vendor,Description:this._promDesciption,plant:this._plant,plantName:this._plantName};this.getOwnerComponent().setModel(new t(o),"promotionDetModel");var n="promMaterialListByPlantSet?$filter=Promotion eq '"+this._promotion+"' and Vendor eq '"+this._vendor+"' and Plant eq '"+this._plant+"'";this.getView().byId("promotionDetTable").setBusy(true);r.getJsonModelAsync(n,function(t,e){var o=t.getProperty("/results");if(o!=null){var n=o[0].CurrencyPlan;var i=o.reduce((t,e)=>+t+(+e["QtyPlan"]||0),0);var r=o.reduce((t,e)=>+t+(+e["PlanPrice"]||0),0);var a={totQtyPlan:Number(i.toFixed(2)),totPlanPrice:Number(r.toFixed(2)),currCode:n};e.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(a),"centroTotDetModel");e.getOwnerComponent().setModel(new sap.ui.model.json.JSONModel(o),"promotionDet")}e.getView().byId("promotionDetTable").setBusy(false)},function(t){t.getView().byId("promotionDetTable").setBusy(false)},this)},buildExportTable:function(){var t=this.getOwnerComponent().getModel("appTxts");var e=[{name:t.getProperty("/foliosCap.promocion"),template:{content:"{Promotion}"}},{name:t.getProperty("/foliosCap.supplier"),template:{content:"{Vendor}"}},{name:t.getProperty("/foliosCapDet.Material"),template:{content:"{Material}"}},{name:t.getProperty("/foliosCapDet.MatDescription"),template:{content:"{Description}"}},{name:t.getProperty("/foliosCapDet.SalesUnit"),template:{content:"{SalesUnit}"}},{name:t.getProperty("/foliosCapDet.planPrice"),template:{content:"{PlanPrice}"}}];this.exportxls("promotionDet","/",e)},handleReceipt:function(){this.oRouter.navTo("detailDetailAporta",{layout:sap.f.LayoutType.ThreeColumnsEndExpanded,folio:this._folio,concepto:this._concepto,gerencia:this._gerencia,importe:this._importe})}})});
sap.ui.define(["sap/ui/core/mvc/Controller","demo/controllers/BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","demo/models/formatter","sap/ui/core/date/UI5Date"],function(e,t,a,r,o,s,d){"use strict";const i=new this.CatalogosDashboard;const l=new this.ReporteGralDashboard;const n=new this.ReporteGpoResolutor;const p=new this.ReporteAvgTiempo;const u=new this.ReporteExecComp;const c=new this.ReporteAclProv;const h=new this.ReporteAnalista;var e=t.extend("sap.m.sample.SplitApp.C",{formatter:s,iconTabBar:undefined,cboxAntiguedad:undefined,dateAlta:undefined,dateAltaGr:undefined,dateAltaAvgT:undefined,dateAltaByProv:undefined,dateAltaAnalista:undefined,cboxTipo:undefined,cboxTipoGr:undefined,cboxTipoAvgT:undefined,cboxTipoExecC:undefined,cboxEstatus:undefined,cboxEstatusGr:undefined,cboxEstatusAvgT:undefined,cboxEstatusExecC:undefined,cboxGrupoRes:undefined,cboxEjercicioExecC:undefined,cboxDateIniExecC:undefined,cboxDateFinExecC:undefined,cboxTipoExecByProv:undefined,cboxEstatusByProv:undefined,cboxGrupoResAnalista:undefined,cboxAnalista:undefined,cboxEstatusAnalista:undefined,cboxTipoExecAnalista:undefined,inptAmountIniProv:undefined,inptAmountEndProv:undefined,inptCantIniProv:undefined,inptCantEndProv:undefined,detailData:[],detailDataGR:[],detailDataAVGT:[],detailDataAclProv:[],donutImporte:undefined,donutCantidad:undefined,barChar:undefined,barCharAvgTRes:undefined,barCharAvgTPend:undefined,rbg1:undefined,rbg2:undefined,onInit:function(){var e=new a;e.setData({today:d.getInstance(new Date)});this.getView().setModel(e);var t=this.byId("idIconTabBar");t.setHeaderMode("Inline");this.catalogModel=new sap.ui.model.odata.v2.ODataModel(i.sUrl);this.reporteGral=new sap.ui.model.odata.v2.ODataModel(l.sUrl);this.reporteGpoRes=new sap.ui.model.odata.v2.ODataModel(n.sUrl);this.reporteAvgTime=new sap.ui.model.odata.v2.ODataModel(p.sUrl);this.reporteExecComp=new sap.ui.model.odata.v2.ODataModel(u.sUrl);this.reporteAclProv=new sap.ui.model.odata.v2.ODataModel(c.sUrl);this.reporteAnalista=new sap.ui.model.odata.v2.ODataModel(h.sUrl);this.configFilterLanguage(this.getView().byId("filterBar"));this.iconTabBar=this.getView().byId("idIconTabBar");this.cboxAntiguedad=this.getView().byId("cboxAntiguedad");this.cboxTipo=this.getView().byId("cboxTipo");this.cboxEstatus=this.getView().byId("cboxEstatus");this.dateAlta=this.getView().byId("dateAlta");this.donutImporte=this.getView().byId("donutImporte");this.donutCantidad=this.getView().byId("donutCantidad");this.dateAltaGr=this.getView().byId("dateAltaGR");this.cboxTipoGr=this.getView().byId("cboxTipoGR");this.cboxEstatusGr=this.getView().byId("cboxEstatusGR");this.cboxGrupoRes=this.getView().byId("cboxGrupoRes");this.dateAltaAvgT=this.getView().byId("dateAltaAvgT");this.cboxTipoAvgT=this.getView().byId("cboxTipoAvgT");this.cboxEstatusAvgT=this.getView().byId("cboxEstatusAvgT");this.cboxTipoExecC=this.getView().byId("cboxTipoExecC");this.cboxEstatusExecC=this.getView().byId("cboxEstatusExecC");this.cboxEjercicioExecC=this.getView().byId("cboxEjercicioExecC");this.barChar=this.getView().byId("barChar");this.barCharAvgTRes=this.getView().byId("barCharAvgTRes");this.barCharAvgTPend=this.getView().byId("barCharAvgTPend");this.cboxDateIniExecC=this.getView().byId("cboxDateIniExecC");this.cboxDateFinExecC=this.getView().byId("cboxDateFinExecC");this.rbg1=this.getView().byId("rbg1");this.rbg2=this.getView().byId("rbg2");this.dateAltaByProv=this.getView().byId("dateAltaByProv");this.cboxTipoExecByProv=this.getView().byId("cboxTipoExecByProv");this.cboxEstatusByProv=this.getView().byId("cboxEstatusByProv");this.inptAmountIniProv=this.getView().byId("inptAmountIniProv");this.inptAmountEndProv=this.getView().byId("inptAmountEndProv");this.inptCantIniProv=this.getView().byId("inptCantIniProv");this.inptCantEndProv=this.getView().byId("inptCantEndProv");this.dateAltaAnalista=this.getView().byId("dateAltaAnalista");this.cboxGrupoResAnalista=this.getView().byId("cboxGrupoResAnalista");this.cboxAnalista=this.getView().byId("cboxAnalista");this.cboxEstatusAnalista=this.getView().byId("cboxEstatusAnalista");this.cboxTipoExecAnalista=this.getView().byId("cboxTipoExecAnalista");this.onLoadTiposAclaracion();this.onLoadAnalistas();this.onLoadGrupos()},searchData:function(){const e=this.iconTabBar.getSelectedKey();switch(e){case"repGeneral":this.onGeneralRep();break;case"repSolGroup":this.onSolvGroupRep();break;case"repAvgTime":this.onAvgTimeRep();break;case"repCompExec":this.onExecCompRep();break;case"repAclarProv":this.onAclProvRep();break;case"repAclarAnalyst":this.onAclaAnalistaRep();break;default:break}},onLoadTiposAclaracion:function(){var e=this;this.catalogModel.read("/CATACLARACIONESSet",{success:function(t){var r=new a({Tipos:t.results});e.getView().setModel(r,"TiposAclaracion")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.tipos"))}})},onLoadAnalistas:function(){var e=this;this.catalogModel.read("/CATANALISTASSet",{success:function(t){var r=new a({Analistas:t.results});e.getView().setModel(r,"AnalistasModel")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.analyst"))}})},onLoadGrupos:function(){var e=this;this.catalogModel.read("/CATRESOLUTORESSet",{success:function(t){var r=new a({Grupos:t.results});e.getView().setModel(r,"GruposModel")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.resolutores"))}})},onGeneralRep:function(){var e=this;var t=this.getConfigModel().getProperty("/supplierInputKey");var s=this.cboxAntiguedad.getSelectedKey();var d=this.dateAlta.getDateValue();var i=this.dateAlta.getSecondDateValue();var l=this.cboxTipo.getSelectedKey();var n=this.cboxEstatus.getSelectedKey();var p=[];if(d!==""&&d!==null&&d!==undefined&&i!==""&&i!==null&&i!==undefined){p.push(new r("Fechaalta",o.BT,d,i))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(t!==undefined&&t!==null&&t!==""){p.push(new r("Acreedor",o.EQ,t))}if(s!==null&&s!==""&&s!==undefined){p.push(new r("Antiguedad",o.EQ,s))}if(l!==null&&l!==""&&l!==undefined){p.push(new r("Tipo",o.EQ,l))}if(n!==null&&n!==""&&n!==undefined){p.push(new r("Estatus",o.EQ,n))}this.reporteGral.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:p,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){let s=Intl.NumberFormat("en-US");var r=t.results[0].TOTALESNAV.results[0];e.detailData=t.results[0].DETALLESNAV.results;r.Cantpagadas=s.format(parseFloat(r.Cantpagadas).toFixed(2));r.Cantpendientes=s.format(parseFloat(r.Cantpendientes).toFixed(2));r.Cantrecibidas=s.format(parseFloat(r.Cantrecibidas).toFixed(2));r.Cantresueltas=s.format(parseFloat(r.Cantresueltas).toFixed(2));r.Importepagadas=s.format(parseFloat(r.Importepagadas).toFixed(2));r.Importependientes=s.format(parseFloat(r.Importependientes).toFixed(2));r.Importerecibidas=s.format(parseFloat(r.Importerecibidas).toFixed(2));r.Importeresueltas=s.format(parseFloat(r.Importeresueltas).toFixed(2));r.Porcentajependientes=parseFloat(r.Porcentajependientes);r.Porcentajeresueltas=parseFloat(r.Porcentajeresueltas);var o=new a(r);e.getView().setModel(o,"CardsModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"))}})},onSolvGroupRep:function(){var e=this;var t=this.dateAltaGr.getDateValue();var s=this.dateAltaGr.getSecondDateValue();var d=this.cboxTipoGr.getSelectedKey();var i=this.cboxEstatusGr.getSelectedKey();var l=this.cboxGrupoRes.getSelectedKey();var n=this.getConfigModel().getProperty("/supplierInputKey");var p=[];if(t!==""&&t!==null&&t!==undefined&&s!==""&&s!==null&&s!==undefined){p.push(new r("Fechaalta",o.BT,t,s))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(d!==null&&d!==""&&d!==undefined){p.push(new r("Tipo",o.EQ,d))}if(i!==null&&i!==""&&i!==undefined){p.push(new r("Estatus",o.EQ,i))}if(l!==null&&l!==""&&l!==undefined){p.push(new r("Gporesolutor",o.EQ,l))}if(n!==undefined&&n!==null&&n!==""){p.push(new r("Acreedor",o.EQ,n))}this.reporteGpoRes.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:p,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;e.detailDataGR=t.results[0].DETALLESNAV.results;console.log(r);var o=new a({oData:r});e.getView().setModel(o,"GpoResModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAvgTimeRep:function(){var e=this;var t=this.dateAltaAvgT.getDateValue();var s=this.dateAltaAvgT.getSecondDateValue();var d=this.cboxTipoAvgT.getSelectedKey();var i=this.cboxEstatusAvgT.getSelectedKey();var l=this.getConfigModel().getProperty("/supplierInputKey");var n=[];if(t!==""&&t!==null&&t!==undefined&&s!==""&&s!==null&&s!==undefined){n.push(new r("Fechaalta",o.BT,t,s))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(d!==null&&d!==""&&d!==undefined){n.push(new r("Tipo",o.EQ,d))}if(i!==null&&i!==""&&i!==undefined){n.push(new r("Estatus",o.EQ,i))}if(l!==undefined&&l!==null&&l!==""){n.push(new r("Acreedor",o.EQ,l))}this.reporteAvgTime.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:n,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;e.detailDataAVGT=t.results[0].DETALLESNAV.results;var o=new a({oData:r});console.log(r);e.getView().setModel(o,"AvgTimeModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onExecCompRep:function(){var e=this;var t=this.getConfigModel().getProperty("/supplierInputKey");var s=this.cboxTipoExecC.getSelectedKey();var d=this.cboxEstatusExecC.getSelectedKey();var i=this.cboxEjercicioExecC.getSelectedKey();var l=this.cboxDateIniExecC.getSelectedKey();var n=this.cboxDateFinExecC.getSelectedKey();var p=[];console.log(this.rbg1.getSelectedIndex());console.log(this.rbg2.getSelectedIndex());if(i!==undefined&&i!==null&&i!==""){p.push(new r("Ejercicio",o.EQ,i))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.year"));return}if(l!==undefined&&l!==null&&l!==""&&n!==undefined&&n!==null&&n!==""){p.push(new r("Mes",o.BT,l,n))}if(t!==undefined&&t!==null&&t!==""){p.push(new r("Acreedor",o.EQ,t))}if(s!==null&&s!==""&&s!==undefined){p.push(new r("Tipo",o.EQ,s))}if(d!==null&&d!==""&&d!==undefined){p.push(new r("Estatus",o.EQ,d))}this.reporteExecComp.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESEJERCICIONAV,DETALLESEJERMESNAV"},filters:p,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){console.log(t);let s=Intl.NumberFormat("en-US");var r=t.results[0].TOTALESNAV.results[0];r.Importepagadasactual=parseFloat(r.Importepagadasactual);r.Importepagadasanterior=parseFloat(r.Importepagadasanterior);r.Importerecibidasactual=parseFloat(r.Importerecibidasactual);r.Importerecibidasanterior=parseFloat(r.Importerecibidasanterior);var o=new a(r);e.getView().setModel(o,"CardsModelExec")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAclProvRep:function(){var e=this;var t=[];var s=this.getConfigModel().getProperty("/supplierInputKey");var d=this.dateAltaByProv.getDateValue();var i=this.dateAltaByProv.getSecondDateValue();var l=this.cboxTipoExecByProv.getSelectedKey();var n=this.cboxEstatusByProv.getSelectedKey();var p=this.inptAmountIniProv.getValue();var u=this.inptAmountEndProv.getValue();var c=this.inptCantIniProv.getValue();var h=this.inptCantEndProv.getValue();if(d!==""&&d!==null&&d!==undefined&&i!==""&&i!==null&&i!==undefined){t.push(new r("Fechaalta",o.BT,d,i))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(s!==undefined&&s!==null&&s!==""){t.push(new r("Acreedor",o.EQ,s))}if(l!==null&&l!==""&&l!==undefined){t.push(new r("Tipo",o.EQ,l))}if(n!==null&&n!==""&&n!==undefined){t.push(new r("Estatus",o.EQ,n))}if(p!==null&&p!==""&&p!==undefined&&u!==null&&u!==""&&u!==undefined){t.push(new r("Importe",o.BT,p,u))}if(c!==null&&c!==""&&c!==undefined&&h!==null&&h!==""&&h!==undefined){t.push(new r("Cantidad",o.BT,c,h))}this.reporteAclProv.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:t,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;var o=new a({oData:r});e.detailDataAclProv=t.results[0].DETALLESNAV.results;e.getView().setModel(o,"TotalesModelProv")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAclaAnalistaRep:function(){var e=this;var t=[];var a=this.dateAltaAnalista.getDateValue();var s=this.dateAltaAnalista.getSecondDateValue();var d=this.cboxGrupoResAnalista.getSelectedKey();var i=this.cboxAnalista.getSelectedKey();var l=this.cboxEstatusAnalista.getSelectedKey();var n=this.cboxTipoExecAnalista.getSelectedKey();if(a!==""&&a!==null&&a!==undefined&&s!==""&&s!==null&&s!==undefined){t.push(new r("Fechaalta",o.BT,a,s))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(d!==null&&d!==""&&d!==undefined){t.push(new r("Gporesolutor",o.EQ,d))}if(i!==null&&i!==""&&i!==undefined){t.push(new r("Analista",o.EQ,i))}if(l!==null&&l!==""&&l!==undefined){t.push(new r("Estatus",o.EQ,l))}if(n!==null&&n!==""&&n!==undefined){t.push(new r("Tipo",o.EQ,n))}this.reporteAnalista.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"DETALLESNAV"},filters:t,success:function(e){console.log(e)},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},downloadExcelGralRep:function(){if(this.detailData.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=this.donutCantidad.getSelectedSegments();var r=this.donutImporte.getSelectedSegments();var o=[];var s=[{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Grupo",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.importepagado"),property:"Importepagado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Diasantiguedad",type:sap.ui.export.EdmType.Number,width:21}];if(a.length===0&&r.length===0||a.length===2&&r.length===2){this.buildExcelSpreadSheet(s,this.detailData,"Reporte Dashboard de Aclaraciones.xlsx")}else{const d=a.concat(r);let i=[];if(d.length>0){d.forEach(function(e){if(e.getLabel()===t.getProperty("/dashboard.card.title.porcetajePend")||e.getLabel()===t.getProperty("/dashboard.card.title.impPend")){o.push("E")}else{o.push("H")}});let a=[...new Set(o)];a.forEach(function(t){let a=e.detailData.filter(e=>e.Estatus===t);i=i.concat(a)});if(i.length>0){this.buildExcelSpreadSheet(s,i,"Reporte Dashboard de Aclaraciones.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}}}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelGpoRes:function(){if(this.detailDataGR.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=[{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGpoRes.excel.fechaasignacion"),property:"Fechaasignacion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGpoRes.excel.folio"),property:"Folio",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(a,this.detailDataGR,"Reporte Dashboard Grupo Resolutor.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelAvgT:function(){if(this.detailDataAVGT.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=[{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGpoRes.excel.fechaasignacion"),property:"Fechaasignacion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:t.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(a,this.detailDataAVGT,"Reporte Dashboard Tiempo Promedio de ResoluciÃ³n.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelAclProv:function(){if(this.detailDataAclProv.length>0){var e=this.getOwnerComponent().getModel("appTxts");var t=[{label:e.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:e.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:e.getProperty("/dashboard.repGpoRes.excel.folio"),property:"Folio",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:e.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:e.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:e.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:e.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.importepagado"),property:"Importepagado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(t,this.detailDataAclProv,"Reporte Dashboard Aclaraciones por Proveedor.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}}});return e});
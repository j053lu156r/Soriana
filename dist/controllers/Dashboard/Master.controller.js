sap.ui.define(["sap/ui/core/mvc/Controller","demo/controllers/BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","demo/models/formatter","sap/ui/core/date/UI5Date"],function(e,t,a,r,o,s,d){"use strict";const l=new this.CatalogosDashboard;const i=new this.ReporteGralDashboard;const p=new this.ReporteGpoResolutor;const n=new this.ReporteAvgTiempo;const c=new this.ReporteExecComp;const u=new this.ReporteAclProv;const h=new this.ReporteAnalista;var e=t.extend("sap.m.sample.SplitApp.C",{formatter:s,iconTabBar:undefined,cboxAntiguedad:undefined,dateAlta:undefined,dateAltaGr:undefined,dateAltaAvgT:undefined,dateAltaByProv:undefined,dateAltaAnalista:undefined,cboxTipo:undefined,cboxTipoGr:undefined,cboxTipoAvgT:undefined,cboxTipoExecC:undefined,cboxEstatus:undefined,cboxEstatusGr:undefined,cboxEstatusAvgT:undefined,cboxEstatusExecC:undefined,cboxGrupoRes:undefined,cboxEjercicioExecC:undefined,cboxDateIniExecC:undefined,cboxDateFinExecC:undefined,cboxTipoExecByProv:undefined,cboxEstatusByProv:undefined,cboxGrupoResAnalista:undefined,cboxAnalista:undefined,cboxEstatusAnalista:undefined,cboxTipoExecAnalista:undefined,inptAmountIniProv:undefined,inptAmountEndProv:undefined,inptCantIniProv:undefined,inptCantEndProv:undefined,detailData:[],detailDataGR:[],detailDataAVGT:[],detailDataAclProv:[],detailDataEC:[],detailDataAclAnalista:[],donutImporte:undefined,donutCantidad:undefined,barChar:undefined,barCharAvgTRes:undefined,barCharAvgTPend:undefined,rbg1:undefined,rbg2:undefined,barsData:undefined,onInit:function(){var e=new a;e.setData({today:d.getInstance(new Date)});this.getView().setModel(e);var t=this.byId("idIconTabBar");t.setHeaderMode("Inline");this.catalogModel=new sap.ui.model.odata.v2.ODataModel(l.sUrl);this.reporteGral=new sap.ui.model.odata.v2.ODataModel(i.sUrl);this.reporteGpoRes=new sap.ui.model.odata.v2.ODataModel(p.sUrl);this.reporteAvgTime=new sap.ui.model.odata.v2.ODataModel(n.sUrl);this.reporteExecComp=new sap.ui.model.odata.v2.ODataModel(c.sUrl);this.reporteAclProv=new sap.ui.model.odata.v2.ODataModel(u.sUrl);this.reporteAnalista=new sap.ui.model.odata.v2.ODataModel(h.sUrl);this.configFilterLanguage(this.getView().byId("filterBar"));this.iconTabBar=this.getView().byId("idIconTabBar");this.cboxAntiguedad=this.getView().byId("cboxAntiguedad");this.cboxTipo=this.getView().byId("cboxTipo");this.cboxEstatus=this.getView().byId("cboxEstatus");this.dateAlta=this.getView().byId("dateAlta");this.donutImporte=this.getView().byId("donutImporte");this.donutCantidad=this.getView().byId("donutCantidad");this.dateAltaGr=this.getView().byId("dateAltaGR");this.cboxTipoGr=this.getView().byId("cboxTipoGR");this.cboxEstatusGr=this.getView().byId("cboxEstatusGR");this.cboxGrupoRes=this.getView().byId("cboxGrupoRes");this.dateAltaAvgT=this.getView().byId("dateAltaAvgT");this.cboxTipoAvgT=this.getView().byId("cboxTipoAvgT");this.cboxEstatusAvgT=this.getView().byId("cboxEstatusAvgT");this.cboxTipoExecC=this.getView().byId("cboxTipoExecC");this.cboxEstatusExecC=this.getView().byId("cboxEstatusExecC");this.cboxEjercicioExecC=this.getView().byId("cboxEjercicioExecC");this.barChar=this.getView().byId("barChar");this.barCharAvgTRes=this.getView().byId("barCharAvgTRes");this.barCharAvgTPend=this.getView().byId("barCharAvgTPend");this.cboxDateIniExecC=this.getView().byId("cboxDateIniExecC");this.cboxDateFinExecC=this.getView().byId("cboxDateFinExecC");this.rbg1=this.getView().byId("rbg1");this.rbg2=this.getView().byId("rbg2");this.dateAltaByProv=this.getView().byId("dateAltaByProv");this.cboxTipoExecByProv=this.getView().byId("cboxTipoExecByProv");this.cboxEstatusByProv=this.getView().byId("cboxEstatusByProv");this.inptAmountIniProv=this.getView().byId("inptAmountIniProv");this.inptAmountEndProv=this.getView().byId("inptAmountEndProv");this.inptCantIniProv=this.getView().byId("inptCantIniProv");this.inptCantEndProv=this.getView().byId("inptCantEndProv");this.dateAltaAnalista=this.getView().byId("dateAltaAnalista");this.cboxGrupoResAnalista=this.getView().byId("cboxGrupoResAnalista");this.cboxAnalista=this.getView().byId("cboxAnalista");this.cboxEstatusAnalista=this.getView().byId("cboxEstatusAnalista");this.cboxTipoExecAnalista=this.getView().byId("cboxTipoExecAnalista");this.onLoadTiposAclaracion();this.onLoadAnalistas();this.onLoadGrupos()},searchData:function(){const e=this.iconTabBar.getSelectedKey();switch(e){case"repGeneral":this.onGeneralRep();break;case"repSolGroup":this.onSolvGroupRep();break;case"repAvgTime":this.onAvgTimeRep();break;case"repCompExec":this.onExecCompRep();break;case"repAclarProv":this.onAclProvRep();break;case"repAclarAnalyst":this.onAclaAnalistaRep();break;default:break}},onLoadTiposAclaracion:function(){var e=this;this.catalogModel.read("/CATACLARACIONESSet",{success:function(t){var r=new a({Tipos:t.results});e.getView().setModel(r,"TiposAclaracion")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.tipos"))}})},onLoadAnalistas:function(){var e=this;this.catalogModel.read("/CATANALISTASSet",{success:function(t){var r=new a({Analistas:t.results});e.getView().setModel(r,"AnalistasModel")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.analyst"))}})},onLoadGrupos:function(){var e=this;this.catalogModel.read("/CATRESOLUTORESSet",{success:function(t){var r=new a({Grupos:t.results});e.getView().setModel(r,"GruposModel")},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.catalog.resolutores"))}})},onGeneralRep:function(){var e=this;var t=this.getConfigModel().getProperty("/supplierInputKey");var s=this.cboxAntiguedad.getSelectedKey();var d=this.dateAlta.getDateValue();var l=this.dateAlta.getSecondDateValue();var i=this.cboxTipo.getSelectedKey();var p=this.cboxEstatus.getSelectedKey();var n=[];if(d!==""&&d!==null&&d!==undefined&&l!==""&&l!==null&&l!==undefined){n.push(new r("Fechaalta",o.BT,d,l))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(t!==undefined&&t!==null&&t!==""){n.push(new r("Acreedor",o.EQ,t))}if(s!==null&&s!==""&&s!==undefined){n.push(new r("Antiguedad",o.EQ,s))}if(i!==null&&i!==""&&i!==undefined){n.push(new r("Tipo",o.EQ,i))}if(p!==null&&p!==""&&p!==undefined){n.push(new r("Estatus",o.EQ,p))}this.reporteGral.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:n,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){let s=Intl.NumberFormat("en-US");var r=t.results[0].TOTALESNAV.results[0];e.detailData=t.results[0].DETALLESNAV.results;r.Cantpagadas=s.format(parseFloat(r.Cantpagadas).toFixed(2));r.Cantpendientes=s.format(parseFloat(r.Cantpendientes).toFixed(2));r.Cantrecibidas=s.format(parseFloat(r.Cantrecibidas).toFixed(2));r.Cantresueltas=s.format(parseFloat(r.Cantresueltas).toFixed(2));r.Importepagadas=s.format(parseFloat(r.Importepagadas).toFixed(2));r.Importependientes=s.format(parseFloat(r.Importependientes).toFixed(2));r.Importerecibidas=s.format(parseFloat(r.Importerecibidas).toFixed(2));r.Importeresueltas=s.format(parseFloat(r.Importeresueltas).toFixed(2));r.Porcentajependientes=parseFloat(r.Porcentajependientes);r.Porcentajeresueltas=parseFloat(r.Porcentajeresueltas);var o=new a(r);e.getView().setModel(o,"CardsModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"))}})},onSolvGroupRep:function(){var e=this;var t=this.dateAltaGr.getDateValue();var s=this.dateAltaGr.getSecondDateValue();var d=this.cboxTipoGr.getSelectedKey();var l=this.cboxEstatusGr.getSelectedKey();var i=this.cboxGrupoRes.getSelectedKey();var p=this.getConfigModel().getProperty("/supplierInputKey");var n=[];if(t!==""&&t!==null&&t!==undefined&&s!==""&&s!==null&&s!==undefined){n.push(new r("Fechaalta",o.BT,t,s))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(d!==null&&d!==""&&d!==undefined){n.push(new r("Tipo",o.EQ,d))}if(l!==null&&l!==""&&l!==undefined){n.push(new r("Estatus",o.EQ,l))}if(i!==null&&i!==""&&i!==undefined){n.push(new r("Gporesolutor",o.EQ,i))}if(p!==undefined&&p!==null&&p!==""){n.push(new r("Acreedor",o.EQ,p))}this.reporteGpoRes.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:n,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;e.detailDataGR=t.results[0].DETALLESNAV.results;console.log(r);var o=new a({oData:r});e.getView().setModel(o,"GpoResModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAvgTimeRep:function(){var e=this;var t=this.dateAltaAvgT.getDateValue();var s=this.dateAltaAvgT.getSecondDateValue();var d=this.cboxTipoAvgT.getSelectedKey();var l=this.cboxEstatusAvgT.getSelectedKey();var i=this.getConfigModel().getProperty("/supplierInputKey");var p=[];if(t!==""&&t!==null&&t!==undefined&&s!==""&&s!==null&&s!==undefined){p.push(new r("Fechaalta",o.BT,t,s))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(d!==null&&d!==""&&d!==undefined){p.push(new r("Tipo",o.EQ,d))}if(l!==null&&l!==""&&l!==undefined){p.push(new r("Estatus",o.EQ,l))}if(i!==undefined&&i!==null&&i!==""){p.push(new r("Acreedor",o.EQ,i))}this.reporteAvgTime.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:p,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;e.detailDataAVGT=t.results[0].DETALLESNAV.results;var o=new a({oData:r});console.log(r);e.getView().setModel(o,"AvgTimeModel")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onExecCompRep:function(){var e=this;var t=this.getConfigModel().getProperty("/supplierInputKey");var s=this.cboxTipoExecC.getSelectedKey();var d=this.cboxEstatusExecC.getSelectedKey();var l=this.cboxEjercicioExecC.getSelectedKey();var i=this.cboxDateIniExecC.getSelectedKey();var p=this.cboxDateFinExecC.getSelectedKey();var n=this.rbg1.getSelectedIndex();var c=this.rbg2.getSelectedIndex();var u=[];if(l!==undefined&&l!==null&&l!==""){u.push(new r("Ejercicio",o.EQ,l))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.year"));return}if(i!==undefined&&i!==null&&i!==""&&p!==undefined&&p!==null&&p!==""){u.push(new r("Mes",o.BT,i,p))}if(t!==undefined&&t!==null&&t!==""){u.push(new r("Acreedor",o.EQ,t))}if(s!==null&&s!==""&&s!==undefined){u.push(new r("Tipo",o.EQ,s))}if(d!==null&&d!==""&&d!==undefined){u.push(new r("Estatus",o.EQ,d))}this.reporteExecComp.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESEJERCICIONAV,DETALLECMPHNAV,DETALLECMPHNAV/DETALLECMPHDETNAV,DETALLECMPHNAV/DETALLECMPHDETNAV/DETALLECMPHDETMESNAV"},filters:u,success:async function(t){console.log(t);if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results[0];e.barsData=t.results[0].DETALLECMPHNAV.results[n].DETALLECMPHDETNAV.results;e.detailDataEC=t.results[0].DETALLESEJERCICIONAV.results;e.currentData=e.barsData.filter(e=>e.Ejercicio===(new Date).getFullYear().toString())[0].DETALLECMPHDETMESNAV.results;e.lastData=e.barsData.filter(e=>e.Ejercicio!==(new Date).getFullYear().toString())[0].DETALLECMPHDETMESNAV.results;r.Importepagadasactual=parseFloat(r.Importepagadasactual);r.Importepagadasanterior=parseFloat(r.Importepagadasanterior);r.Importerecibidasactual=parseFloat(r.Importerecibidasactual);r.Importerecibidasanterior=parseFloat(r.Importerecibidasanterior);var o=new a(r);e.getView().setModel(o,"CardsModelExec");e.currentData=await e.formatData(e.currentData,n,c,e);e.lastData=await e.formatData(e.lastData,n,c,e);var s=new a({data:e.currentData[0]});e.getView().setModel(s,"CurrentData1");var d=new a({data:e.currentData[1]});e.getView().setModel(d,"CurrentData2");var l=new a({data:e.lastData[0]});e.getView().setModel(l,"LastData1");var l=new a({data:e.lastData[1]});e.getView().setModel(l,"LastData2")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAclProvRep:function(){var e=this;var t=[];var s=this.getConfigModel().getProperty("/supplierInputKey");var d=this.dateAltaByProv.getDateValue();var l=this.dateAltaByProv.getSecondDateValue();var i=this.cboxTipoExecByProv.getSelectedKey();var p=this.cboxEstatusByProv.getSelectedKey();var n=this.inptAmountIniProv.getValue();var c=this.inptAmountEndProv.getValue();var u=this.inptCantIniProv.getValue();var h=this.inptCantEndProv.getValue();if(d!==""&&d!==null&&d!==undefined&&l!==""&&l!==null&&l!==undefined){t.push(new r("Fechaalta",o.BT,d,l))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(s!==undefined&&s!==null&&s!==""){t.push(new r("Acreedor",o.EQ,s))}if(i!==null&&i!==""&&i!==undefined){t.push(new r("Tipo",o.EQ,i))}if(p!==null&&p!==""&&p!==undefined){t.push(new r("Estatus",o.EQ,p))}if(n!==null&&n!==""&&n!==undefined&&c!==null&&c!==""&&c!==undefined){t.push(new r("Importe",o.BT,n,c))}if(u!==null&&u!==""&&u!==undefined&&h!==null&&h!==""&&h!==undefined){t.push(new r("Cantidad",o.BT,u,h))}this.reporteAclProv.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"TOTALESNAV,DETALLESNAV"},filters:t,success:function(t){if(t.results[0].TOTALESNAV.results.length>0){var r=t.results[0].TOTALESNAV.results;var o=new a({oData:r});e.detailDataAclProv=t.results[0].DETALLESNAV.results;e.getView().setModel(o,"TotalesModelProv")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},onAclaAnalistaRep:function(){var e=this;var t=[];var s=this.dateAltaAnalista.getDateValue();var d=this.dateAltaAnalista.getSecondDateValue();var l=this.cboxGrupoResAnalista.getSelectedKey();var i=this.cboxAnalista.getSelectedKey();var p=this.cboxEstatusAnalista.getSelectedKey();var n=this.cboxTipoExecAnalista.getSelectedKey();if(s!==""&&s!==null&&s!==undefined&&d!==""&&d!==null&&d!==undefined){t.push(new r("Fechaalta",o.BT,s,d))}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.dates"));return}if(l!==null&&l!==""&&l!==undefined){t.push(new r("Gporesolutor",o.EQ,l))}if(i!==null&&i!==""&&i!==undefined){t.push(new r("Analista",o.EQ,i))}if(p!==null&&p!==""&&p!==undefined){t.push(new r("Estatus",o.EQ,p))}if(n!==null&&n!==""&&n!==undefined){t.push(new r("Tipo",o.EQ,n))}this.reporteAnalista.read("/DASHMAINSet",{method:"GET",urlParameters:{$expand:"DETALLESNAV,DETALLESGPONAV"},filters:t,success:function(t){console.log(t);if(t.results[0].DETALLESGPONAV.results.length>0){var r=t.results[0].DETALLESGPONAV.results;r.forEach((e,t)=>{r[t].Totalaclarado=parseFloat(e.Totalaclarado)});console.log(r);var o=new a({oData:r});e.detailDataAclAnalista=t.results[0].DETALLESNAV.results;e.getView().setModel(o,"AclaracionesAnalista")}else{sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.data"))}},error:function(t){sap.m.MessageBox.error(e.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.error.execute"))}})},formatData:async function(e,t,a,r){var o="";var s=[[],[]];if(t===0){o="Totalreclamado"}else if(t===1){o="Totalaclarado"}await e.forEach((e,t)=>{let d={};if(a===0){d["valor"]=parseInt(e.Cantidad)}else if(a===1){d["valor"]=parseFloat(e[o])}d["mes"]=r.formatMonth(e["Mes"]);if(t<=5){s[0].push(d)}else{s[1].push(d)}});return s},formatMonth:function(e){switch(e){case"01":return"Enero";case"02":return"Febrero";case"03":return"Marzo";case"04":return"Abril";case"05":return"Mayo";case"06":return"Junio";case"07":return"Julio";case"08":return"Agosto";case"09":return"Septiembre";case"10":return"Octubre";case"11":return"Noviembre";case"12":return"Diciembre"}},onChangeRadioBtnSelect:function(e){this.onExecCompRep()},downloadExcelGralRep:function(){if(this.detailData.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=this.donutCantidad.getSelectedSegments();var r=this.donutImporte.getSelectedSegments();var o=[];var s=[{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Grupo",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.importepagado"),property:"Importepagado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Diasantiguedad",type:sap.ui.export.EdmType.Number,width:21}];if(a.length===0&&r.length===0||a.length===2&&r.length===2){this.buildExcelSpreadSheet(s,this.detailData,"Reporte Dashboard de Aclaraciones.xlsx")}else{const d=a.concat(r);let l=[];if(d.length>0){d.forEach(function(e){if(e.getLabel()===t.getProperty("/dashboard.card.title.porcetajePend")||e.getLabel()===t.getProperty("/dashboard.card.title.impPend")){o.push("E")}else{o.push("H")}});let a=[...new Set(o)];a.forEach(function(t){let a=e.detailData.filter(e=>e.Estatus===t);l=l.concat(a)});if(l.length>0){this.buildExcelSpreadSheet(s,l,"Reporte Dashboard de Aclaraciones.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}}}}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelGpoRes:function(){if(this.detailDataGR.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=[{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGpoRes.excel.fechaasignacion"),property:"Fechaasignacion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGpoRes.excel.folio"),property:"Folio",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(a,this.detailDataGR,"Reporte Dashboard Grupo Resolutor.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelAvgT:function(){if(this.detailDataAVGT.length>0){var e=this;var t=this.getOwnerComponent().getModel("appTxts");var a=[{label:t.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:t.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:t.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:t.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:t.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGpoRes.excel.fechaasignacion"),property:"Fechaasignacion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:t.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:t.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:t.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:t.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(a,this.detailDataAVGT,"Reporte Dashboard Tiempo Promedio de Resolución.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelAclProv:function(){if(this.detailDataAclProv.length>0){var e=this.getOwnerComponent().getModel("appTxts");var t=[{label:e.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:e.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:e.getProperty("/dashboard.repGpoRes.excel.folio"),property:"Folio",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:e.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.estatus"),property:"Estatus",width:10},{label:e.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:e.getProperty("/dashboard.repGpoRes.excel.analista"),property:"Analista",width:25},{label:e.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.importepagado"),property:"Importepagado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(t,this.detailDataAclProv,"Reporte Dashboard Aclaraciones por Proveedor.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},onDownloadExcelEjecComp:function(){if(this.detailDataEC.length>0){var e=this.getOwnerComponent().getModel("appTxts");var t=[{label:e.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:e.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:e.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:e.getProperty("/dashboard.repGeneral.excel.totalrecla"),property:"Totalreclamado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGpoRes.table.quantity"),property:"Cantidad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(t,this.detailDataEC,"Reporte Dashboard Ejecutivo Comparativo.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}},downloadExcelAnalista:function(){if(this.detailDataAclAnalista.length>0){var e=this.getOwnerComponent().getModel("appTxts");var t=[{label:e.getProperty("/dashboard.repGpoRes.excel.folio"),property:"Folio",width:26},{label:e.getProperty("/dashboard.repGeneral.excel.fechaalta"),property:"Fechaalta",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:e.getProperty("/dashboard.repGeneral.excel.proveedor"),property:"Proveedor",type:sap.ui.export.EdmType.Number,width:12},{label:e.getProperty("/dashboard.repGeneral.excel.razonsocial"),property:"Razonsocial",width:40},{label:e.getProperty("/dashboard.repGeneral.excel.tipo"),property:["Tipo","Desctipo"],template:"{0} {1}",width:26},{label:e.getProperty("/dashboard.repAclarAnalist.excel.subtotalAclarado"),property:"Subtotalacl",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repAclarAnalist.excel.ivaAclarado"),property:"Ivaacl",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/dashboard.repGeneral.excel.totalaclarado"),property:"Totalaclarado",type:sap.ui.export.EdmType.Number,delimiter:true,scale:2,width:20},{label:e.getProperty("/clarifications.headerAnalyst"),property:"Analista",width:50},{label:e.getProperty("/dashboard.repGeneral.excel.grupo"),property:"Nombregrupo",width:25},{label:e.getProperty("/dashboard.repGpoRes.excel.fechaasignacion"),property:"Fechaasignacion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:e.getProperty("/dashboard.repGeneral.excel.fechasolucion"),property:"Fechasolucion",type:sap.ui.export.EdmType.Date,format:"dddd, d.mmmm yyyy",width:30},{label:e.getProperty("/dashboard.repGeneral.excel.diasantiguedad"),property:"Antiguedad",type:sap.ui.export.EdmType.Number,width:21}];this.buildExcelSpreadSheet(t,this.detailDataAclAnalista,"Reporte Dashboard Aclaraciones por analista.xlsx")}else{sap.m.MessageBox.error(this.getOwnerComponent().getModel("appTxts").getProperty("/dashboard.excel.error.data"))}}});return e});
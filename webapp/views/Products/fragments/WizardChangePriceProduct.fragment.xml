<core:FragmentDefinition  controllerName="demo.controllers.Products.Master"
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
	xmlns:f="sap.f"
	xmlns:form="sap.ui.layout.form"
	xmlns:u="sap.ui.unified"
    xmlns:l="sap.ui.layout"
	xmlns:layout="sap.ui.layout"
    xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">>
	<Dialog
		id="changePriceDialog"
		showHeader="false"
		verticalScrolling="false"
		contentHeight="95%"
		contentWidth="96%"
        
        >
		<f:DynamicPage
			toggleHeaderOnTitleClick="false"
			showFooter="true">
			<f:title>
				<f:DynamicPageTitle>
					<f:heading>
						<Title text="{appTxts>/products.titleChangePrice}"/>
					</f:heading>
				</f:DynamicPageTitle>
			</f:title>

			<f:content>
						
                <VBox>
                    <MessageStrip class="sapUiSmallMarginBottom"
								text="{appTxts>/products.messageStripPrice}"
								showIcon="true"/>

                                <Link
                                                text="{appTxts>/products.linkMassiveChange}"
                                                target="_blank"
                                                href="./assets/GUIAS/Guia_cambio_costos.pdf"
                                                class="sapUiSmallMarginBottom" />

                                <Link
                                                text="{appTxts>/products.linkFormatChange}"
                                                target="_blank"
                                                href="./assets/GUIAS/FormatoCambioCostos.txt"
                                                class="sapUiSmallMarginBottom" />

                    <HBox class="sapUiResponsiveContentPadding" >
                        <l:HorizontalLayout>
                            <l:VerticalLayout class="sapUiLargeMarginEnd">

                            <Label text="" labelFor="fileUploaderChangeCost" />
                                <u:FileUploader
                                    id="fileUploaderChangeCost"
                                    name="myFileUpload"
                                    change="addAttachChangeTxt"
                                    fileType="txt"
                                    placeholder="{appTxts>/products.placeholderFileUploader}"
                                    tooltip="{appTxts>/products.tooltipFileUploader}"/>
                                <Button
                                    text="{appTxts>/products.uploadFilePrice}"
                                    press="handleUploadPressChangePrice"/>

                            </l:VerticalLayout>                            

                            <l:VerticalLayout class="sapUiLargeMarginEnd" >

                                <Label text="{appTxts>/products.personalBuyerEmail}" labelFor="inputDestinatario" />
                                <Input id="inputDestinatario" 
                                        placeholder="{appTxts>/products.enterEmailplaceholder}"
                                        type="Email"
                                        liveChange=""
                                        enabled="{= ${ETMODIFY>/Paginated/results/length} > 0}"/>

                            </l:VerticalLayout>

                            <l:VerticalLayout class="sapUiLargeMarginEnd">

                                <Label text="Letter" labelFor="fileUploaderChangeCost" required="true"/>
                                <u:FileUploader
                                    id="fileUploaderLetter"
                                    name="myLetterUpload"
                                    change="addAttachLetter"
                                    fileType="xlsx,xls"
                                    placeholder="{appTxts>/products.placeholderFileUploader}"
                                    tooltip="{appTxts>/products.tooltipFileUploader}"
                                    enabled="{= ${ETMODIFY>/Paginated/results/length} > 0}"/>
                            </l:VerticalLayout>

                        </l:HorizontalLayout>
                    </HBox>

                    <ScrollContainer width="100%" horizontal="true" vertical="true" focusable="true">

                        <Table  mode="MultiSelect" id="tableItemsChangePrice"
                            items="{ path : 'ETMODIFY>/Paginated/results'}"  visible="true"  width="220%">
                            <headerToolbar>
                                <OverflowToolbar>
                                    <Button text="{appTxts>/products.deletePrice}" id="btnDeleteChangePriceRow" press=".deleteRow('tableItemsChangePrice','ETMODIFY')" type="Emphasized" />
                                    <Button icon="sap-icon://excel-attachment" text="{appTxts>/global.export}" press=".buildExportTableCostos" visible="{= ${ETMODIFY>/Paginated/results/length} > 0}" />
                                    <ToolbarSpacer/>
                                    <Select 
                                        id="paginatedChangePriceProducts"
                                        visible="{= ${ETMODIFY>/Paginated/results/length} > 0 }"
                                        change=".paginar(${$parameters>/selectedItem}, 'ETMODIFY', '', 'tableItemsChangePrice')">
                                        <items>
                                            <core:Item key="10" text="10"/>
                                            <core:Item key="20" text="20"/>
                                            <core:Item key="50" text="50"/>
                                            <core:Item key="100" text="100"/>
                                        </items>
                                    </Select>
                                </OverflowToolbar>
                            </headerToolbar>
                            <columns>
                                <Column width="auto" hAlign="Left">
                                    <header>
                                        <Text text="{appTxts>/products.organizePrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left">
                                    <header>
                                        <Text text="{appTxts>/products.centerPrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                        <Text text="{appTxts>/products.codePrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.descriptionPrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.costPrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.newCostPrice}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <!-- Nuevas columnas -->
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.normalDiscount}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.additionalDiscount}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.discountEarlyPay}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.subtitleBonusType}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.CostDiff}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.CompCentral}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
                                    <header>
                                    <Text text="{appTxts>/products.CargoCosto}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                                    </header>
                                    <footer/>
                                </Column>
                                                
                            </columns>
                            <items>
                                <ColumnListItem>
                                    <cells>
                                        <ObjectIdentifier text="{ETMODIFY>OrgCompras}" />
                                        <ObjectIdentifier text="{ETMODIFY>Centro}" />
                                        <ObjectIdentifier text="{ETMODIFY>Codigoean}" />
                                        <ObjectIdentifier text="{ETMODIFY>Descrip}" />
                                        <ObjectIdentifier text="${ETMODIFY>Costobant}" />
                                        <Input value="{ETMODIFY>Costobnuevo}" type="Number" liveChange="validateCstBrutNuevo" customData:cba="{ETMODIFY>Costobant}" customData:ean="{ETMODIFY>Codigoean}" editable="false"/>
                                        <ObjectIdentifier text="{ETMODIFY>DNormal}%" />
                                        <ObjectIdentifier text="{ETMODIFY>DAdicional}%" />
                                        <ObjectIdentifier text="{ETMODIFY>DPronto}%" />
                                        <ObjectIdentifier text="{= (${ETMODIFY>PDBonif} > 0 ) ? (${ETMODIFY>PDBonif} + '%') : ('$' + ${ETMODIFY>MBonif}) }" />
                                        <ObjectIdentifier text="{ETMODIFY>PDifCos}%" />
                                        <ObjectIdentifier text="{ETMODIFY>PComCen}%" />
                                        <ObjectIdentifier text="{= (${ETMODIFY>PCargoC} > 0 ) ? (${ETMODIFY>PCargoC} + '%') : ('$' + ${ETMODIFY>MCargoC}) }" />
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>

                     </ScrollContainer>

                    <OverflowToolbar visible="{= ${ETMODIFY>/Paginated/results/length} > 0 }">
                        <Text text="{ETMODIFY>/Paginated/initRow} - {ETMODIFY>/Paginated/endRow} {appTxts>/pagination.of} {ETMODIFY>/results/length}" />
                        <ToolbarSpacer/>
                        <Button type="Default" icon="sap-icon://slim-arrow-left" press=".prevPagination(${ETMODIFY>/Paginated/iterator}, ${ETMODIFY>/Paginated/initRow}, 'ETMODIFY', '')" enabled="{= ${ETMODIFY>/Paginated/iterator} !== 1}" />
                        <Button type="Default" icon="sap-icon://slim-arrow-right" press=".nextPagination(${ETMODIFY>/Paginated/iterator}, ${ETMODIFY>/Paginated/endRow}, 'ETMODIFY', '')" enabled="{= ${ETMODIFY>/Paginated/endRow} !== ${ETMODIFY>/results/length}}" />
                    </OverflowToolbar>
                    
                </VBox>
					
			</f:content>

			<f:footer>
				<OverflowToolbar>
                    <Button text="{appTxts>/products.sendChangePrice}" id="btnSaveChangePriceRow" press="saveChangePrice" type="Emphasized" enabled="{= ${ETMODIFY>/Paginated/results/length} > 0 &amp;&amp; true }"/>
                    <ToolbarSpacer/>
                    <Button	text="{appTxts>/products.cancel}" type="Emphasized" press=".closeDialog('changePriceDialog')"/>
                </OverflowToolbar>
			</f:footer>
		</f:DynamicPage>
	</Dialog>
</core:FragmentDefinition>
<mvc:View controllerName="demo.controllers.Factoraje.DetalleFactoraje"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns="sap.m"
	xmlns:f="sap.f"
	xmlns:layout="sap.ui.layout" height="100%">
	<f:DynamicPage id="dynamicPageId">
		<!-- DynamicPage Title -->
		<f:title>
			<f:DynamicPageTitle>
				<f:heading>
					<Title text="{detailFactoraje>/document}"/>
				</f:heading>
				<!--
					<f:breadcrumbs>
						<Breadcrumbs>
							<Link text="Home" />
							<Link text="Page 1" />
							<Link text="Page 2" />
							<Link text="Page 3" />
							<Link text="Page 4" />
							<Link text="Page 5" />
						</Breadcrumbs>
					</f:breadcrumbs>
				-->
				<f:expandedContent>
					<Label text="{detailFactoraje>/document}"/>
				</f:expandedContent>
				<f:snappedContent>
					<Label text="{detailFactoraje>/document}"/>
				</f:snappedContent>
				<f:snappedTitleOnMobile>
					<Title text="{detailFactoraje>/document}"/>
				</f:snappedTitleOnMobile>


				<f:navigationActions>
					<Button icon="sap-icon://full-screen" type="Transparent" press="handleFullScreen" id="enterFullScreenBtn" tooltip="Enter Full Screen Mode" visible="{= ${/actionButtonsInfo/midColumn/fullScreen} !== null }" />
					<Button icon="sap-icon://exit-full-screen" type="Transparent" press="handleExitFullScreen" id="exitFullScreenBtn" tooltip="Exit Full Screen Mode" visible="{= ${/actionButtonsInfo/midColumn/exitFullScreen} !== null }" />
					<Button icon="sap-icon://decline" type="Transparent" press="handleClose" tooltip="Close column" visible="{= ${/actionButtonsInfo/midColumn/closeColumn} !== null }" />
				</f:navigationActions>
			</f:DynamicPageTitle>
		</f:title>
		<!-- DynamicPage Header -->
		<f:header>
			<f:DynamicPageHeader pinnable="true">
				<layout:HorizontalLayout allowWrapping="true">
					<layout:VerticalLayout class="sapUiMediumMarginEnd">
						<ObjectAttribute title="{appTxts>/pay.form}" text=""/>
						<ObjectAttribute title="{appTxts>/pay.headerLimitDate}" text="{detailFactoraje>/date}"/>
						<ObjectAttribute title="{appTxts>/plan.datePay}" text="{detailFactoraje>/date}"/>
 					</layout:VerticalLayout>


					<layout:VerticalLayout class="sapUiMediumMarginEnd">

					</layout:VerticalLayout>
				</layout:HorizontalLayout>

			</f:DynamicPageHeader>
		</f:header>
		<f:content>

			<!-- tabla con agrupacion -->
			<VBox>

				<!-- Tabla v2 con columnas filtrables  -->

				<Table visible="true" xmlns="sap.ui.table"
					   selectionMode="None"
					   id="detailsStatementList"
					   xmlns:m="sap.m" rows="{GroupedFactoraje>/Hierarchy/movimientos}"   ariaLabelledBy="title" width="100%">
					<extension>
						<m:OverflowToolbar style="Clear">
							<m:Breadcrumbs id="breadcrumb" />
							<!--
                                                        <m:Title id="title" text="{appTxts>/state.detail} ({totales>/Detalles/results/length})"/>
                                                        -->
							<m:ToolbarSpacer/>
							<m:CheckBox id="checkPartidas_" text="Partidas pendientes de pago" select="onTableGrouping" visible="false"/>
							<m:Button icon="sap-icon://excel-attachment" text="{appTxts>/global.export}" press=".buildExportTable" visible="{= ${totales>/Detalles/results/length} > 0}" />

							<!--
                            <m:Select visible="{= ${totales>/Detalles/Paginated/results/length} > 0 }" change="paginar( ${$parameters>/selectedItem} )">
                                <m:items>
                                    <core:Item key="10" text="10"/>
                                    <core:Item key="20" text="20"/>
                                    <core:Item key="50" text="50"/>
                                    <core:Item key="100" text="100"/>
                                </m:items>
                            </m:Select>
                            -->

						</m:OverflowToolbar>
					</extension>
					<columns>

						<Column sortProperty="name"   id="tipoColumn" width="40%">
							<m:Label text="{appTxts>/aportaciones.concepto}" />
							<template>

								<m:ObjectAttribute 	active="true" text="{GroupedFactoraje>name}" press="conceptoSelect" />



							</template>
						</Column>

						<Column sortProperty="IdNumTipomov" filterProperty="IdNumTipomov"  id="tipoMovColumn" width="30%">
							<m:Label text="{appTxts>/aportaciones.concepto}" />
							<template>
								<m:ObjectAttribute press="onDocumentDevolucionPress"  active="{= ${GroupedFactoraje>IdNumTipomov} === '12'}"  text="{GroupedFactoraje>IdNumTipomov} {GroupedFactoraje>DescTipomov}"  />
							</template>
						</Column>

						<Column    id="statusColumn" width="15%">
							<m:Label text="{appTxts>/state.status}" />
							<template>
								<m:Text text="{=  (${GroupedFactoraje>Pendt} === true) ? 'Pendiente' : ( ${GroupedFactoraje>Belnr} === ${GroupedFactoraje>Augbl} ? 'Pago' : 'Contabilizado'  ) }" wrapping="false" />
							</template>
						</Column>

						<!--sucursal folio -->
						<Column filterProperty="Sucursal" sortProperty="Sucursal"  id="sucursalColumn" width="15%">
							<m:Label text="{appTxts>/order.branch}" />
							<template>
								<m:Text text="{GroupedFactoraje>Sucursal}" wrapping="false" />
							</template>
						</Column>
						<Column  sortProperty="Folio"  filterProperty="Folio" id="folio2Column" width="15%">
							<m:Label text="{appTxts>/invoice.folio}" />
							<template>
								<m:Text text="{GroupedFactoraje>Folio}" wrapping="false" />
							</template>
						</Column>


						<!-- end sucursal folio -->


						<Column  filterType="sap.ui.model.type.Integer" filterProperty="Belnr" sortProperty="Belnr" id="folioColumn" width="20%">
							<m:Label text="{appTxts>/state.folio}" />
							<template>
								<m:ObjectIdentifier titlePress="onDocumentPress" titleActive="{= ${GroupedFactoraje>IdNumTipomov} !== '12'}" title="{GroupedFactoraje>Belnr}"  />
							</template>
						</Column>
						<Column  sortProperty="Xblnr" filterProperty="Xblnr"  id="referenceColumn" width="20%">
							<m:Label text="{appTxts>/snote.invoice}" />
							<template>
								<m:Text text="{GroupedFactoraje>Xblnr}" wrapping="false" />
							</template>
						</Column>

						<Column sortProperty="Tienda" filterProperty="Tienda" id="typeDocColumn"  width="20%">
							<m:Label text="{appTxts>/aportaciones.tienda}" />
							<template>
								<m:Text text="{GroupedFactoraje>Tienda}" wrapping="false" />
							</template>
						</Column>

						<Column    sortProperty="Budat"                      id="dateColumn"
								   width="15%">
							<m:Label text="{appTxts>/state.date}" />
							<template>
								<m:Text text="{GroupedFactoraje>Budat}" wrapping="false" />
							</template>
						</Column>
						<Column id="amountColumn" sortProperty="Wrbtr" width="20%">
							<m:Label text="{appTxts>/state.amount}" />
							<template>
								<m:ObjectNumber number= "{parts: [{path: 'GroupedFactoraje>Wrbtr'}, {path: 'totales>/Banks'}], type:'sap.ui.model.type.Currency', formatOptions: {showMeasure:false}}" />
							</template>
						</Column>
						<Column sortProperty="MCondicion"  id="mCondicionColumn" width="20%">
							<m:Label text="Mejor CondiciÃ³n" />
							<template>
								<m:Text text="{GroupedFactoraje>MCondicion}" wrapping="false" />
							</template>
						</Column>



						<Column  id="bloqueoColumn" width="10%">
							<m:Label text="Bloqueado" />
							<template>
								<m:ObjectMarker visible="{=  ${GroupedFactoraje>BloqueoFlag} === '' ? false : true }" type="LockedBy" additionalInfo="{GroupedFactoraje>DescripcionBloqueo}" press="onMarkerPress" />
							</template>
						</Column>
						<Column sortProperty="Augbl" id="conciliacionColumn" width="15%">
							<m:Label text="{appTxts>/state.conciliation}" />
							<template>
								<m:Text text="{GroupedFactoraje>Augbl}" wrapping="false" />

							</template>
						</Column>

						<!--columnas nuevas para totales -->
						<Column sortProperty="totalRegs" id="totalRegColumn"  width="15%">
							<m:Label text="{appTxts>/state.totalReg}" />
							<template>
								<m:ObjectNumber number="{GroupedFactoraje>totalRegs}" />
							</template>
						</Column>
						<Column  sortProperty="totalDebit"   id="debitColumn"  width="15%">
							<m:Label text="{appTxts>/state.debit}" />
							<template>
								<m:ObjectNumber number= "{parts: [{path: 'GroupedFactoraje>totalDebit'}, {path: 'totales>/Banks'}], type:'sap.ui.model.type.Currency', formatOptions: {showMeasure:false}}" />
							</template>
						</Column>
						<Column sortProperty="totalCredit"   id="creditColumn" width="15%">
							<m:Label text="{appTxts>/state.credit}" />
							<template>
								<m:ObjectNumber number="{parts: [{path: 'GroupedFactoraje>totalCredit'}, {path: 'totales>/Banks'}], type:'sap.ui.model.type.Currency', formatOptions: {showMeasure:false}}" />
							</template>
						</Column>

						<Column sortProperty="totalCosto"   id="costoColumn" width="15%">
							<m:Label text="Costo" />
							<template>
								<m:ObjectNumber number="{parts: [{path: 'GroupedFactoraje>cost'}, {path: 'GroupedFactoraje>moneda'}], type:'sap.ui.model.type.Currency', formatOptions: {showMeasure:true}}" />
							</template>
						</Column>


					</columns>

				</Table>




				<OverflowToolbar id="sumFooter" visible="true">

					<Text width="60%"  text="Total" />

					<Text width="20%"  text="{GroupedFactoraje>/Hierarchy/totalR}"/>

					<Text   width="20%"
							text= "{parts: [{path: 'GroupedFactoraje>/Hierarchy/totalCostos'}, {path: 'GroupedFactoraje>/Hierarchy/moneda'}], type:'sap.ui.model.type.Currency', formatOptions: {showMeasure:true}}"
					/>

				</OverflowToolbar>



			</VBox>



		</f:content>
		<!-- DynamicPage Footer -->
		<f:footer>

		</f:footer>
	</f:DynamicPage>
</mvc:View>

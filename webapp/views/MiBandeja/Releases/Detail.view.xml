<mvc:View displayBlock="true" controllerName="demo.controllers.MiBandeja.Releases.Detail" height="100%"
		xmlns="sap.uxap"
		xmlns:mvc="sap.ui.core.mvc"
		xmlns:m="sap.m"
		xmlns:f="sap.f"
        xmlns:card="sap.f.cards"
        xmlns:core="sap.ui.core" 
        xmlns:rte="sap.ui.richtexteditor"
		xmlns:form="sap.ui.layout.form">

	<ObjectPageLayout id="releaseDetail" showTitleInHeaderContent="true" upperCaseAnchorBar="false">
        <headerTitle>
            <ObjectPageDynamicHeaderTitle>
                <expandedHeading>
                    
                    <m:Title text="{appTxts>/release.subject} : {release>/ESdmens/Ztext}" wrapping="true"/>
                </expandedHeading>

                <snappedHeading>
                    <m:FlexBox fitContainer="true" alignItems="Center">
                        <m:Title text="{release>/ESdmens/Ztext}" wrapping="true" />
                    </m:FlexBox>
                </snappedHeading>

                <expandedContent>
                    <m:HBox>
                        <m:Label text="{appTxts>/realese.sender}:" class="sapUiTinyMarginEnd" />
                        <m:Text text="{release>/ESdmens/Zremi}"/>
                    </m:HBox>
                    <m:HBox>
                        <m:Label text="{appTxts>/release.publishdate}:" class="sapUiTinyMarginEnd" />
                        <m:Text text="{release>/ESdmens/Zfechaenvio}"/>
                    </m:HBox>
                </expandedContent>

                <snappedContent>
                    <m:HBox>
                        <m:Label text="Remitente:" class="sapUiTinyMarginEnd" />
                        <m:Text text="{path: 'release>/ESdmens/Zremi'}"/>
                    </m:HBox>
                    <m:HBox>
                        <m:Label text="Fecha:" class="sapUiTinyMarginEnd" />
                        <m:Text text="{path: 'release>/ESdmens/Zfechaenvio', formatter: '.formatDate'}"/>
                    </m:HBox>
                </snappedContent>

                <snappedTitleOnMobile>
                    <m:Title text="{release>/IText}"/>
                </snappedTitleOnMobile>

                            <navigationActions>
                                <m:OverflowToolbarButton type="Transparent" icon="sap-icon://full-screen" press="handleFullScreen" id="enterFullScreenBtn" tooltip="Enter Full Screen Mode" visible="{= ${/actionButtonsInfo/midColumn/fullScreen} !== null }"/>
                                <m:OverflowToolbarButton type="Transparent" icon="sap-icon://exit-full-screen" press="handleExitFullScreen" id="exitFullScreenBtn" tooltip="Exit Full Screen Mode" visible="{= ${/actionButtonsInfo/midColumn/exitFullScreen} !== null }"/>
                                <m:OverflowToolbarButton type="Transparent" icon="sap-icon://decline" press="handleClose"  tooltip="Close column" visible="{= ${/actionButtonsInfo/midColumn/closeColumn} !== null }" />
                            </navigationActions>
                    			<actions>
                           
                          
                         
                            
                           
						</actions>
            </ObjectPageDynamicHeaderTitle>
        </headerTitle>

        <sections>
		<ObjectPageSection title="{appTxts>/release.message}">
				<subSections>
					<ObjectPageSubSection>
						<blocks>
							<form:SimpleForm
								
							  editable="false"
                layout="ResponsiveGridLayout"
                
                labelSpanXL="2"
                labelSpanL="2"
                labelSpanM="2"
                labelSpanS="2"
                adjustLabelSpan="true"
                emptySpanXL="0"
                emptySpanL="0"
                emptySpanM="0"
                emptySpanS="0"
                columnsXL="1"
                columnsL="1"
                columnsM="1"
                singleContainerFullSize="false">
                                <form:toolbar>
                                    <m:Toolbar>
                                    
                                                                             
									 
                                    
					                <m:ToolbarSpacer />
                                          <m:Button
                                                text="{appTxts>/release.guardar}"
                                                type="Emphasized"
                                                visible="{= ${userdata>/ERol} === '0001' || ${userdata>/ERol} === '0002' ? true : false }"
                                                press="editRelease"
                                            />         
                                                              
                                    </m:Toolbar>
                                </form:toolbar>
								<form:content>
                                  
                                                               
                                    <rte:RichTextEditor id="message" editorType="TinyMCE5" customToolbar="false" 
                                showGroupFont="true" showGroupLink="true" showGroupInsert="false" showGroupStructure="true"
                                width="100%" value="{release>/IText}" ready="readyEditor" beforeEditorInit="befInit" height="350px"  />

                                  

                                
								</form:content>
							</form:SimpleForm>
						</blocks>
					</ObjectPageSubSection>
				</subSections>
			</ObjectPageSection>




        <ObjectPageSection title="{appTxts>/release.receiver}" showTitle="false">
                <subSections>
                  
                    <ObjectPageSubSection>
                        <blocks>
                        
                          <m:VBox>
			<m:Table sticky="HeaderToolbar,InfoToolbar,ColumnHeaders" 
                noDataText="{appTxts>/release.nodata}" 
                id="complPagoList1"
                alternateRowColors="true"                 
                items="{path: 'release>/ZTTSP_MENSPROVSet/Paginated/results', sorter : { path : 'Nombreprov', descending : true }}"
                	fixedLayout="true"	
		        contextualWidth="Auto"
				growing="true" >
                <m:headerToolbar>
                    <m:OverflowToolbar>
                        <m:Title text="{appTxts>/release.receiver} ({release>/ZTTSP_MENSPROVSet/results/length})" />
                        <m:ToolbarSpacer/>
                        <m:Select 
                            visible="{= ${release>/ZTTSP_MENSPROVSet/Paginated/results/length} > 0 }"
                            change=".paginateValue(${$parameters>/selectedItem}, 'release', '/ZTTSP_MENSPROVSet')">
                            <m:items>
                                <core:Item key="10" text="10"/>
                                <core:Item key="20" text="20"/>
                                <core:Item key="50" text="50"/>
                                <core:Item key="100" text="100"/>
                            </m:items>
                        </m:Select>
                    </m:OverflowToolbar>
                </m:headerToolbar>
                
				<m:columns>
					<m:Column width="auto" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
						<m:header>
							<m:Text text="{appTxts>/release.subject}" maxLines="2" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</m:header>
						<m:footer/>
					</m:Column>
					<m:Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
						<m:header>
							<m:Text text="{appTxts>/user.email}"  maxLines="2" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</m:header>
						<m:footer/>
					</m:Column>
                    <m:Column  hAlign="Right"  width="6rem" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
						<m:header>
							<m:Text text="{appTxts>/release.read}" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</m:header>
						<m:footer/>
					</m:Column>
                     <m:Column  width="10rem" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
						<m:header>
							<m:Text text="{appTxts>/release.readdate}"  maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</m:header>
						<m:footer/>
					</m:Column>
                     <m:Column width="10rem" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" mergeDuplicates="false">
						<m:header>
							<m:Text text="{appTxts>/release.readhr}"  maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</m:header>
						<m:footer/>
					</m:Column>
                   
				</m:columns>
				<m:items>
					<m:ColumnListItem type="Active">
						<m:cells>
							<m:Text text="{release>Nombreprov}"  maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                            <m:Text text="{release>Zemail}"  maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
                            <m:Text text="{release>Zleido}"  maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
							<m:Text xmlns="sap.m" text="{release>Zfechaleido}"/>
                            <m:Text xmlns="sap.m" text="{release>Zhoraleido}"/>
						</m:cells>
					</m:ColumnListItem>
				</m:items>
			</m:Table>
            <m:OverflowToolbar visible="{= ${release>/ZTTSP_MENSPROVSet/Paginated/results/length} > 0 }">
                <m:Text text="{release>/ZTTSP_MENSPROVSet/Paginated/initRow} - {release>/ZTTSP_MENSPROVSet/Paginated/endRow} {appTxts>/pagination.of} {release>/ZTTSP_MENSPROVSet/results/length}" />
                <m:ToolbarSpacer/>
                <m:Button type="Default" icon="sap-icon://slim-arrow-left" press=".prevPagination(${release>/ZTTSP_MENSPROVSet/Paginated/iterator}, ${release>/ZTTSP_MENSPROVSet/Paginated/initRow}, 'release', '/ZTTSP_MENSPROVSet')" enabled="{= ${release>/ZTTSP_MENSPROVSet/Paginated/iterator} !== 1}" />
                <m:Button type="Default" icon="sap-icon://slim-arrow-right" press=".nextPagination(${release>/ZTTSP_MENSPROVSet/Paginated/iterator}, ${release>/ZTTSP_MENSPROVSet/Paginated/endRow}, 'release', '/ZTTSP_MENSPROVSet')" enabled="{= ${release>/ZTTSP_MENSPROVSet/Paginated/endRow} !== ${release>/ZTTSP_MENSPROVSet/results/length}}" />
            </m:OverflowToolbar>
            </m:VBox>
                           
                        </blocks>
                    </ObjectPageSubSection>
                </subSections>
        </ObjectPageSection>











            <ObjectPageSection title="{appTxts>/release.attachments}" showTitle="false">
                <subSections>
                  
                    <ObjectPageSubSection>
                        <blocks>
                            <f:GridList
                                id="gridList"
                                headerText="{appTxts>/release.attachments}"
                                items="{release>/ETATTACHNAV/results}"
                            >
                                <f:GridListItem>
                                    <m:VBox class="sapUiSmallMargin">
                                        <m:layoutData>
                                            <m:FlexItemData growFactor="1"  />
                                        </m:layoutData>
                                        <f:Card >
                                            <f:header>
                                                <card:Header
                                                    title="{release>Zatname}"
                                                    subtitle=""
                                                    iconSrc="{path: 'release>Zdoctype', formatter: '.setIconAttach'}" />
                                            </f:header>
                                            <f:content>
                                                <m:Button icon="sap-icon://download" text="{appTxts>/global.download}" press=".downloadAttach(${release>Zdocvalue64}, ${release>Zdoctype}, ${release>Zatname})" />
                                            </f:content>
                                        </f:Card>
                                    </m:VBox>
                            </f:GridListItem>
                        </f:GridList>
                        </blocks>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
        </sections>
    </ObjectPageLayout>
    
</mvc:View>
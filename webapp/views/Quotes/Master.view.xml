<mvc:View displayBlock="true" 
    xmlns:f="sap.f" 
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:fb="sap.ui.comp.filterbar" 
    xmlns:vm="sap.ui.comp.variants" 
    xmlns:unified="sap.ui.unified"
    xmlns="sap.m" 
    xmlns:core="sap.ui.core"
	 controllerName="demo.controllers.Quotes.Master" height="100%">
	<f:DynamicPage  
		class="sapUiContentPadding">
        <!-- DynamicPage Title -->
        <f:title>
            <f:DynamicPageTitle backgroundDesign="Transparent">
                <f:heading>
                    <vm:VariantManagement standardItemText="{appTxts>/quotes.quotes}">
                    </vm:VariantManagement>
                </f:heading>
                <f:actions>
                    <ToolbarSpacer/>
                    <Button text="{appTxts>/quotes.uploadQuote}" type="Emphasized" press="openUploadDialog"/>
                </f:actions>
               <f:actions>
                    <ToolbarSpacer/>
                    <Button text="{appTxts>/quotes.createQuote}" type="Emphasized" press=".createQuote"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>
        <!-- DynamicPage Header -->
        <f:header>
            <f:DynamicPageHeader pinnable="true">
                <f:content>
                    <fb:FilterBar id="filterBar"  header="Header"
		                reset="onReset" search="searchData" clear="clearFilters" cancel="onCancel" 
		                filtersDialogClosed = "onFiltersDialogClosed"
		                showRestoreButton="false" showClearButton="false" useToolbar="false"> 
			
                        <fb:filterGroupItems>
                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Ab" label="{appTxts>/quotes.supplier}" mandatory="true" partOfCurrentVariant="true" visibleInFilterBar="true">
                                <fb:control>
                                    <Input
                                        id="supplierInput"
                                        placeholder="{appTxts>/quotes.supplier}"
                                        showSuggestion="true"
                                        valueHelpOnly="true"
                                        showValueHelp="true"
                                        valueHelpRequest=".onValueHelpRequest"
                                        value="{configSite>/supplierInput}">
                                    </Input>
                                </fb:control>
                            </fb:FilterGroupItem>
                        
                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="A" label="{appTxts>/quotes.quoteFolio}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="true">
                                <fb:control>
                                    <Input
                                        id="quoteFolioInput"
                                        placeholder="{appTxts>/quotes.quoteFolio}"
                                        showSuggestion="true"
                                        >
                                    </Input>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="F1" groupTitle="Fechas" name="Fecha de entrega" label="{appTxts>/quotes.quoteDate}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="true">
                                <fb:control>
                                    <DateRangeSelection id="dateRange" required="false"/>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Tipo cita" label="{appTxts>/quotes.quoteType}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <ComboBox
                                        id="quoteType"
                                        items="{
                                                path: 'appoinmentsCatalogs>/ETIPOCITANAV/results',
                                                sorter: { path: 'Name' }
                                            }">
                                        <core:Item key="{appoinmentsCatalogs>ZNumcita}" text="{appoinmentsCatalogs>ZTipocita}" />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Product type" label="{appTxts>/quotes.productType}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <Input
                                        id="productType"
                                        placeholder="{appTxts>/quotes.productType}"
                                        showSuggestion="true"
                                        valueHelpOnly="false"
                                        showValueHelp="true"
                                        valueHelpRequest="helpProductType(false)"
                                        />
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Turn" label="{appTxts>/quotes.turn}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <ComboBox
                                        id="quoteTurn"
                                        items="{
                                                path: 'appoinmentsCatalogs>/ETIPOTURNONAV/results'
                                            }">
                                        <core:Item key="{appoinmentsCatalogs>ZNumturno}" text="{appoinmentsCatalogs>ZTipoturno}" />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Status" label="{appTxts>/quotes.quoteStatus}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <ComboBox
                                        id="quoteStatus"
                                        items="{
                                                path: 'appoinmentsCatalogs>/ETIPOSTATUSNAV/results'
                                            }">
                                        <core:Item key="{appoinmentsCatalogs>ZNumstatus}" text="{appoinmentsCatalogs>ZTipostatus}" />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Tipo unidad" label="{appTxts>/quotes.unitType}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <ComboBox
                                        id="quoteUnitType"
                                        items="{
                                                path: 'appoinmentsCatalogs>/ETIPOUNIDADNAV/results'
                                            }">
                                        <core:Item key="{appoinmentsCatalogs>ZNumunidad}" text="{appoinmentsCatalogs>ZTipounidad}" />
                                    </ComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="A2" label="{appTxts>/quotes.order}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <Input
                                        id="orderInput"
                                        placeholder="{appTxts>/quotes.order}"
                                        showSuggestion="true"
                                        >
                                    </Input>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="__$INTERNAL$" name="Sucursal" label="{appTxts>/quotes.branch}" mandatory="false" partOfCurrentVariant="true" visibleInFilterBar="false">
                                <fb:control>
                                    <Input
                                        id="branchInput"
                                        placeholder="{appTxts>/quotes.branch}"
                                        showSuggestion="true"
                                        valueHelpOnly="false"
                                        showValueHelp="true"
                                        valueHelpRequest="helpBranch"
                                        >
                                    </Input>
                                </fb:control>
                            </fb:FilterGroupItem>
                        </fb:filterGroupItems>

	                </fb:FilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
		<f:content>
            <VBox>
            <SegmentedButton
                selectedKey="{quoteConfigModel>/spc1Visible}">
                <items>
                    <SegmentedButtonItem key="Table" icon="sap-icon://table-view"/>
                    <SegmentedButtonItem key="Calendar" icon="sap-icon://calendar"/>
                </items>
            </SegmentedButton>
			<Table sticky="HeaderToolbar,InfoToolbar,ColumnHeaders" 
                noDataText="{appTxts>/quotes.noData}" 
                autoPopinMode="true"
                fixedLayout="false"
                growing="true"
                visible="{= ${quoteConfigModel>/spc1Visible} !== 'Calendar' }"
                id="tableQuotes"
                mode="None" 
                alternateRowColors="true" 
                items="{path: 'tableQuotesModel>/ECITASCONSNAV/Paginated/results', sorter : { path : 'ZfolioCita', descending : true }}"                
				>
                <headerToolbar>
                    <OverflowToolbar>
                        <Title text="{appTxts>/quotes.quotes} ({tableQuotesModel>/ECITASCONSNAV/results/length})" />
                        <ToolbarSpacer/>
                        <Button icon="sap-icon://excel-attachment" text="{appTxts>/global.export}" 
                        press=".buildExportTable"
                        visible="{= ${tableQuotesModel>/ECITASCONSNAV/results/length} > 0}"
                        />
                        <Select 
                            visible="{= ${tableQuotesModel>/ECITASCONSNAV/Paginated/results/length} > 0 }"
                            change=".paginateValue(${$parameters>/selectedItem}, 'tableQuotesModel', '/ECITASCONSNAV')">
                            <items>
                                <core:Item key="10" text="10"/>
                                <core:Item key="20" text="20"/>
                                <core:Item key="50" text="50"/>
                                <core:Item key="100" text="100"/>
                            </items>
                        </Select>
                    </OverflowToolbar>
                </headerToolbar>
				<columns>
                	<Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Phone" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.branch}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
                    <Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Phone" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.quoteFolio}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
					<Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Phone" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.quoteDate}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
					<Column width="auto" vAlign="Top" minScreenWidth="Tablet" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.quoteType}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
					<Column width="auto" hAlign="Left" vAlign="Top" minScreenWidth="Tablet" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.quoteStatus}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
                    <Column width="auto" vAlign="Top" minScreenWidth="Tablet" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.productType}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column> 
                    <Column width="auto" vAlign="Top" minScreenWidth="Tablet" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.turn}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>
                    <Column width="auto" vAlign="Top" minScreenWidth="Tablet" mergeDuplicates="false">
						<header>
							<Text text="{appTxts>/quotes.unitType}" width="auto" maxLines="1" wrapping="false" textAlign="Begin" textDirection="Inherit"/>
						</header>
						<footer/>
					</Column>     
				</columns>
				<items>
					<ColumnListItem type="Navigation" press="onListItemPress">                    
						<cells>
                            <Text xmlns="sap.m" text="{tableQuotesModel>Zsucursal} - {tableQuotesModel>Zdescrsucursal}"/>
                            <Text xmlns="sap.m" text="{tableQuotesModel>ZfolioCita}"/>
							<Text xmlns="sap.m" text="{tableQuotesModel>Zfecharegcita}"/>
							<Text xmlns="sap.m" text="{tableQuotesModel>ZtipoCita}"/>
                            <Text xmlns="sap.m" text="{tableQuotesModel>Zstatus}"/>                          
                            <Text xmlns="sap.m" text="{tableQuotesModel>ZtipoProd}"/>   
                            <Text xmlns="sap.m" text="{tableQuotesModel>ZTipoturno}"/>  
                            <Text xmlns="sap.m" text="{tableQuotesModel>ZtipoUnidad}"/>  
						</cells>
					</ColumnListItem>
				</items>
			</Table>
            <OverflowToolbar visible="{= ${quoteConfigModel>/spc1Visible} !== 'Calendar'}">
                <Text text="{tableQuotesModel>/ECITASCONSNAV/Paginated/initRow} - {tableQuotesModel>/ECITASCONSNAV/Paginated/endRow} {appTxts>/pagination.of} {tableQuotesModel>/ECITASCONSNAV/results/length}" />
                <ToolbarSpacer/>
                <Button type="Default" icon="sap-icon://slim-arrow-left" press=".prevPagination(${tableQuotesModel>/ECITASCONSNAV/Paginated/iterator}, ${tableQuotesModel>/ECITASCONSNAV/Paginated/initRow}, 'tableQuotesModel', '/ECITASCONSNAV')" enabled="{= ${tableQuotesModel>/ECITASCONSNAV/Paginated/iterator} !== 1}" />
                <Button type="Default" icon="sap-icon://slim-arrow-right" press=".nextPagination(${tableQuotesModel>/ECITASCONSNAV/Paginated/iterator}, ${tableQuotesModel>/ECITASCONSNAV/Paginated/endRow}, 'tableQuotesModel', '/ECITASCONSNAV')" enabled="{= ${tableQuotesModel>/ECITASCONSNAV/Paginated/endRow} !== ${tableQuotesModel>/ECITASCONSNAV/results/length}}" />
            </OverflowToolbar>

            <SinglePlanningCalendar
			id="SPC1"
            visible="{= ${quoteConfigModel>/spc1Visible} === 'Calendar' }"
			class="sapUiSmallMarginTop"
			title= "{appTxts>/quotes.quotes} ({tableQuotesModel>/ECITASCONSNAV/results/length})"
            startDate="{path: 'quoteConfigModel>/startDate'}"
            appointmentSelect="onAppointmentItemPress"
			appointments="{path: 'tableQuotesModel>/ECITASCONSNAV/Paginated/results'}">
			<views>
				<SinglePlanningCalendarMonthView key="MonthView" title="Month" />
			</views>
			<appointments>
				<unified:CalendarAppointment
					title= "{appTxts>/quotes.quoteFolio} - {tableQuotesModel>ZfolioCita}"
					text= "{tableQuotesModel>ZfolioCita} - {tableQuotesModel>Nlifnr}"
					startDate= "{ path: 'tableQuotesModel>Zfecharegcita', formatter: '.formatDateQuote'}"
					endDate= "{ path: 'tableQuotesModel>Zfecharegcita', formatter: '.formatDateQuote'}">
				</unified:CalendarAppointment>
			</appointments>
		</SinglePlanningCalendar>
            </VBox>
		</f:content>
	</f:DynamicPage>
</mvc:View>